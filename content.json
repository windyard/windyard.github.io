{"pages":[],"posts":[{"title":"Testing post","text":"This is a testing post.Created at February 7th, 2019, 21:26","link":"/2019/02/07/Testing-post/"},{"title":"ã€Œè¯‘ã€ å¦‚ä½•åœ¨ Vue ä¸­ï¼ˆå®‰å…¨çš„ï¼‰ä½¿ç”¨ jQuery æ’ä»¶","text":"ä½œè€…ï¼šAnthony Gore åŸæ–‡é“¾æ¥ï¼šHow To (Safely) Use A jQuery Plugin With Vue.js åœ¨ä¸€ä¸ª UI ä¸­åŒæ—¶ä½¿ç”¨ Vue.js å’Œ jQuery å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚å¦‚æœå¯èƒ½çš„è¯è¦é¿å…è¿™ç§æƒ…å½¢ã€‚ ä¸è¿‡æ—¢ç„¶ä½ å·²ç»çœ‹åˆ°è¿™é‡Œäº†ï¼Œä¼°è®¡ä½ æ˜¯éè¦åŒæ—¶ç”¨ Vue å’Œ jQuery ä¸å¯äº†ã€‚æˆ–è®¸æ˜¯å®¢æˆ·åšæŒè¦ä½¿ç”¨æŸä¸ª jQuery æ’ä»¶è€Œä½ åˆæ²¡æ—¶é—´å»æŠŠå®ƒç”¨ Vue é‡å†™ã€‚ åªè¦ä½ è°¨æ…çš„æ“ä½œï¼Œè¿˜æ˜¯å¯ä»¥åŒæ—¶ä½¿ç”¨ Vue å’Œ jQuery çš„ã€‚è¿™ç¯‡æ–‡ç« é‡Œæˆ‘å°†æ¼”ç¤ºå¦‚ä½•åœ¨ Vue é¡¹ç›®ä¸­ä½¿ç”¨ä¸€ä¸ª jQuery UI çš„ Datepicker æ’ä»¶ã€‚ è€Œä¸”ä¸ºäº†å°å°çš„ç‚«ä¸€ä¸‹æŠ€ï¼Œæˆ‘è¿˜è¦åœ¨ jQuery æ’ä»¶å’Œ Vue ä¹‹é—´ä¼ é€’æ•°æ®ï¼ ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ç¤ºä¾‹ä»£ç  JS Bin jQuery UI Datepicker åŒæ—¶ä½¿ç”¨ jQuery å’Œ Vue å­˜åœ¨çš„é—®é¢˜ä¸ºä»€ä¹ˆè¯´è¿™ç§ç”¨æ³•ä¼šæœ‰æ½œåœ¨çš„é£é™©å‘¢ï¼Ÿ å¯ä»¥è¯´ Vue æ˜¯ä¸€ä¸ªå æœ‰æ¬²éå¸¸å¼ºçš„æ¡†æ¶ï¼Œå¥¹æ€»æƒ³å®Œå…¨æ§åˆ¶ä½ äº¤ç»™å¥¹çš„è¿™éƒ¨åˆ† DOM å…ƒç´ ï¼ˆä¼ é€’ç»™ el å±æ€§çš„å…ƒç´ ï¼‰ã€‚å¦‚æœ jQuery ä¿®æ”¹äº† Vue ç®¡è¾–ä¸‹çš„å…ƒç´ ï¼Œä¾‹å¦‚ä¸ºæŸä¸ªå…ƒç´ æ·»åŠ äº†ä¸€ä¸ª classï¼Œ Vue æ— æ³•æ„ŸçŸ¥åˆ°è¿™æ¬¡ä¿®æ”¹ï¼Œæ‰€ä»¥ä¸‹æ¬¡ Vue æ›´æ–° DOM æ—¶ä¼šç›´æ¥è¦†ç›– jQuery æ‰€åšçš„ä¿®æ”¹ã€‚ è§£å†³æ–¹æ¡ˆï¼šæŠŠ jQuery æ’ä»¶åŒ…è£…æˆ Vue ç»„ä»¶æ—¢ç„¶ Vue å’Œ jQuery ç»ä¸ä¼šåˆ†äº«åŒä¸€ä»½ DOMï¼Œæˆ‘ä»¬å¿…é¡»è®© Vue åˆ†å‰²å‡ºä¸€å—åŒºåŸŸäº¤ç»™ jQueryã€‚ çœ‹èµ·æ¥æŠŠ jQuery æ’ä»¶åŒ…è£…æˆ Vue ç»„ä»¶æ˜¯ä¸ªåŠæ³•ï¼Œå› ä¸ºï¼š æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Vue ç”Ÿå‘½å‘¨æœŸå‹¾å­æ¥è®¾ç½®æˆ–å¸è½½ jQuery ä»£ç  æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»„ä»¶æ¥å£ä½¿ç”¨ props å’Œ events æ¥ä¸ Vue åº”ç”¨é€šä¿¡ ç»„ä»¶å¯ä»¥é€šè¿‡è®¾ç½® v-once é¿å…è¢« Vue æ›´æ–° è®¾ç½® jQuery UI Datepickeré¦–å…ˆè¦åšçš„å½“ç„¶æ˜¯åœ¨ä½ çš„é¡¹ç›®ä¸­å¼•å…¥ jQuery UI æ’ä»¶ã€‚ç„¶åä½ åªéœ€è¦æŠŠ datepicker æ’ä»¶ç»‘å®šåˆ°ä¸€ä¸ª input å…ƒç´ ä¸Šï¼š 1Date: &lt;input id=\"datepicker\"&gt; é€‰ä¸­å¹¶åˆå§‹åŒ– Datepicker 1$('#datepicker').datepicker(); Datepicker ç»„ä»¶æˆ‘ä»¬çš„ datepicker ç»„ä»¶å¾ˆç®€å•ï¼Œtemplate åªæœ‰ä¸€ä¸ª input å…ƒç´ ï¼š 1234567Vue.component('date-picker', function() &#123; template: '&lt;input/&gt;'&#125;);new Vue(&#123; el: '#app'&#125;); 123&lt;div id=\"app\"&gt; Date: &lt;date-picker&gt;&lt;/date-picker&gt;&lt;/div&gt; æ³¨æ„ï¼šç»„ä»¶åªæ˜¯ä¸º jQuery æ’ä»¶æä¾›ä¸€ä¸ªåŒ…è£…ã€‚ä¸è¦è¯•å›¾ä¸ºç»„ä»¶å…ƒç´ æ·»åŠ ä»»ä½• data å±æ€§æˆ– Vue directives æˆ– slotsã€‚ æ’ä»¶å®ä¾‹åŒ–åœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ this.$el è€Œä¸æ˜¯ input å…ƒç´ çš„ ID æ¥é€‰æ‹©æ’ä»¶å…ƒç´ ï¼Œæ¯ä¸ª Vue ç»„ä»¶éƒ½å¯ä»¥åƒè¿™æ ·æ¥è®¿é—®åˆ°è‡ªå·±çš„æ ¹å…ƒç´ ã€‚æˆ‘ä»¬è¿™é‡Œçš„æ ¹å…ƒç´ å°±æ˜¯ inputã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå…ƒç´ å¼•ç”¨ä¼ é€’ç»™ jQuery é€‰æ‹©å™¨å¹¶è°ƒç”¨ datepicker æ–¹æ³•ã€‚ä¾‹ï¼š$(this.$el).datepicker()ã€‚ æ³¨æ„æˆ‘ä»¬çš„ä»£ç æ˜¯å†™åœ¨åœ¨ Vue ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ mounted é˜¶æ®µï¼Œå› ä¸ºåœ¨æ­¤ä¹‹å‰ this.$el è¿˜æ˜¯ undefined çŠ¶æ€ã€‚ 123456Vue.component('date-picker', function() &#123; template: '&lt;input/&gt;', mounted: function() &#123; $(this.$el).datepicker(); &#125;&#125;); å¸è½½ç±»ä¼¼çš„ï¼Œå¸è½½ datepicker æ’ä»¶åŒæ ·ä¹Ÿä¼šç”¨åˆ°ç”Ÿå‘½å‘¨æœŸå‹¾å­ã€‚æ³¨æ„æˆ‘ä»¬å¿…é¡»åœ¨ beforeDestroy é˜¶æ®µæ‰§è¡Œå¸è½½ï¼Œå› ä¸ºåœ¨è¿™ä¸ªé˜¶æ®µ input å…ƒç´ ä»ç„¶å­˜åœ¨äº DOM ä¸­ï¼Œæˆ‘ä»¬æ‰èƒ½é€‰ä¸­å®ƒï¼ˆåœ¨ destroy é˜¶æ®µå®ƒå°†å˜æˆ undefinedï¼‰ã€‚ 123456789Vue.component('date-picker', &#123; template: '&lt;input/&gt;', mounted: function() &#123; $(this.$el).datepicker(); &#125;, beforeDestroy: function() &#123; $(this.$el).datepicker('hide').datepicker('destroy'); &#125;&#125;); é€šè¿‡ props ä¼ é€’å‚æ•°ä¸ºäº†ä½¿æˆ‘ä»¬çš„ç»„ä»¶å¯å¤ç”¨ï¼Œæœ€å¥½è®©å®ƒèƒ½æ¥å—è‡ªå®šä¹‰è®¾ç½®å‚æ•°ï¼Œä¾‹å¦‚é€šè¿‡è®¾ç½®å±æ€§ dateFormat æ¥åˆ¶å®šæ—¥æœŸæ ¼å¼ã€‚é€šè¿‡ props å¯ä»¥å®ç°è¿™ä¸€ç›®æ ‡ï¼š 12345678910Vue.component('date-picker', &#123; template: '&lt;input/&gt;', props: [ 'dateFormat' ], mounted: function() &#123; $(this.$el).datepicker(&#123; dateFormat: this.dateFormat &#125;); &#125;, beforeDestroy: function() &#123; ... &#125;&#125;); 123&lt;div id=\"app\"&gt; &lt;date-picker date-format=\"yy-mm-dd\"&gt;&lt;/date-picker&gt;&lt;/div&gt; è®© jQuery æ¥æ”¶æ›´æ–°æ¯”æ–¹è¯´ä½ ä¸æ»¡è¶³äºåªæ˜¯ä¼ ç»™ dateFormat prop ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æŠŠ dateFormat è®¾ç½®æˆ Vue æ ¹å®ä¾‹ä¸Šçš„ä¸€ä¸ªå±æ€§ï¼Œä¾‹ï¼š 123456var vm = new Vue(&#123; data: &#123; ... dateFormat: 'yy-mm-dd' &#125;&#125;); 123&lt;div id=\"app\"&gt; &lt;date-picker date-format=\"dateFormat\"&gt;&lt;/date-picker&gt;&lt;/div&gt; è¿™æ ·ä¸€æ¥ï¼ŒdateFormat å°±å˜æˆäº†ä¸€ä¸ªå“åº”å¼çš„ data å±æ€§ã€‚ä½ å¯ä»¥éšæ—¶åœ¨åº”ç”¨ä¸­æ›´æ”¹å®ƒçš„å€¼ï¼š 12// æ›´æ”¹æ—¥æœŸæ˜¾ç¤ºæ ¼å¼vm.dateFormat = 'yy-dd-mm'; ç”±äº dateFormat prop æ˜¯ datepicker ç»„ä»¶çš„ mounted é’©å­çš„ä¾èµ–é¡¹ï¼Œæ›´æ–°å®ƒçš„å€¼å°†å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚è¿™å°±ä¸å¦™äº†ã€‚å› ä¸º jQuery å·²ç»åœ¨ input å…ƒç´ ä¸Šè®¾ç½®å¥½äº† datepicker å¹¶ä¸”æ·»åŠ äº†è‡ªå·±çš„ class å’Œ äº‹ä»¶ç›‘å¬ã€‚ç»„ä»¶é‡æ–°æ¸²æŸ“å°†å¯¼è‡´ input å…ƒç´ è¢«æ›¿æ¢è€Œä¸” jQuery æ‰€åšçš„è®¾ç½®ä¹Ÿè¢«é‡ç½®äº†ã€‚ æˆ‘ä»¬éœ€è¦å°†ç»„ä»¶è®¾ç½®ä¸ºæ¥æ”¶æ•°æ®ä¸é‡æ–°æ¸²æŸ“â€¦ v-oncev-once æŒ‡ä»¤ç”¨äºç¼“å­˜ä¸€ä¸ªåŒ…å«å¤§é‡é™æ€å†…å®¹çš„ç»„ä»¶ã€‚å¯¼è‡´çš„ç»“æœå°±æ˜¯è¿™ä¸ªç»„ä»¶æ¸²æŸ“ä¸ä¼šå—æ•°æ®æ›´æ–°çš„å½±å“ã€‚ æˆ‘ä»¬çš„ç»„ä»¶æ­£å¥½ç”¨åˆ°è¿™ä¸ªç‰¹æ€§ï¼Œå› ä¸ºå®ƒæœ‰æ•ˆçš„é¿å…äº†è¢« Vue é‡æ–°æ¸²æŸ“ã€‚å› æ­¤æˆ‘ä»¬æœ‰ç†ç”±ç›¸ä¿¡ jQuery å°†å¯ä»¥åœ¨åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸­æ— éšœç¢çš„æ“ä½œè¿™ä¸ª input å…ƒç´ ã€‚ 123&lt;div id=\"app\"&gt; &lt;date-picker date-format=\"yy-mm-dd\" v-once&gt;&lt;/date-picker&gt;&lt;/div&gt; ä» jQuery å‘ Vue ä¼ é€’æ•°æ®å¦‚æœæˆ‘ä»¬ä¸èƒ½åœ¨ app ä¸­è·å–åˆ° datepicker é€‰ä¸­çš„æ—¥æœŸï¼Œé‚£å®ƒå°±æ²¡å•¥ç”¨äº†ã€‚è®©æˆ‘ä»¬æ¥å®ç°è¿™ä¸ªç›®æ ‡ã€‚ é¦–å…ˆç»™ root å®ä¾‹ä¸€ä¸ª date å±æ€§ï¼š 123456new Vue(&#123; el: '#app', data: &#123; date: null &#125;&#125;); 1234&lt;div id=\"app\"&gt; &lt;date-picker date-format=\"yy-mm-dd\" v-once&gt;&lt;/date-picker&gt; &lt;p&gt;&#123;&#123; date &#125;&#125;&lt;/p&gt;&lt;/div&gt; datepicker æ’ä»¶æœ‰ä¸€ä¸ª onSelect å›è°ƒå‡½æ•°æ¥å¤„ç†é€‰ä¸­æ—¥æœŸçš„æ“ä½œã€‚é€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶å‘å‡ºæ•°æ®ã€‚ 123456789mounted: function() &#123; var self = this; $(this.$el).datepicker(&#123; dateFormat: this.dateFormat, onSelect: function(date) &#123; self.$emit('update-date', date); &#125; &#125;);&#125; åœ¨æ ¹å®ä¾‹ä¸Šç›‘å¬è‡ªå®šä¹‰äº‹ä»¶å¹¶æ¥æ”¶æ–°æ•°æ®ï¼š 1234&lt;div id=\"app\"&gt; &lt;date-picker @update-date=\"updateDate\" date-format=\"yy-mm-dd\" v-once&gt;&lt;/date-picker&gt; &lt;p&gt;&#123;&#123; date &#125;&#125;&lt;/p&gt;&lt;/div&gt; 1234567891011new Vue(&#123; el: '#app', data: &#123; date: null &#125;, methods: &#123; updateDate: function(date) &#123; this.date = date; &#125; &#125;&#125;); æ„Ÿè°¢è¿™ä¸ª Stack Overflow å›ç­” æä¾›çš„çµæ„Ÿ","link":"/2019/02/08/Use-jquery-in-vue/"},{"title":"Hello World 2","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2019/02/02/hello-world/"},{"title":"ã€Œè¯‘ã€7 ä¸ªç”¨ Async/Await å–ä»£ Promise çš„ç†ç”±ï¼ˆæ•™ç¨‹ï¼‰","text":"ä½œè€…ï¼šMostafa Gaafar åŸæ–‡é“¾æ¥ï¼š7 Reasons Why JavaScript Async/Await Is Better Than Plain Promises (Tutorial) Async/Await ç”± NodeJS 7.6 ç‰ˆæœ¬å¼•å…¥ï¼Œç°åœ¨å·²ç»è¢«æ‰€æœ‰ç°ä»£æµè§ˆå™¨æ‰€æ”¯æŒã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯ JS è‡ª 2017 å¹´ä»¥æ¥æœ€æ£’çš„æ›´æ–°ã€‚å¦‚æœä½ ä¸ä¿¡ï¼Œè¿™é‡Œæœ‰ä¸€å †å¸¦ç€ç¤ºä¾‹çš„ç†ç”±å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆä½ åº”è¯¥å°½å¿«æ¥å—å®ƒå¹¶ä¸”æ°¸ä¸å†å›å¤´ã€‚ Async/Await æ¦‚è¿°å¯¹é‚£äº›ä»æœªå¬è¯´è¿‡è¿™ä¸ªè¯é¢˜çš„\bï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç®€ä»‹ï¼š Asyne/Await æ˜¯ä¸€ç§æ–°çš„å¼‚æ­¥ä»£ç å†™æ³•ã€‚ä»¥å‰ç”¨äºå†™å¼‚æ­¥ä»£ç çš„æ˜¯ callback å’Œ Promiseã€‚ Async/Await å®é™…ä¸Šæ˜¯åŸºäº Promise çš„è¯­æ³•ç³–ã€‚æ— æ³•ç”¨åœ¨åªæœ‰ callback æˆ– node callba çš„æƒ…å½¢ä¸­ã€‚ Async/Await è·Ÿ Promise ä¸€æ ·æ˜¯éé˜»å¡çš„ã€‚ Async/Await ä½¿å¾—å¼‚æ­¥ä»£ç çš„å†™æ³•å’Œè¡Œä¸ºéƒ½æœ‰ç‚¹ç±»ä¼¼åŒæ­¥ä»£ç ã€‚è¿™æ­£æ˜¯å®ƒå¼ºå¤§çš„åœ°æ–¹ã€‚ è¯­æ³•å‡è®¾æœ‰ä¸€ä¸ª getJSON å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promiseï¼Œç„¶åè¿™ä¸ª Promise ä¼šè§£æå‡ºå‡ ä¸ª JSON å¯¹è±¡ã€‚æˆ‘ä»¬è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰“å°å‡º JSON å¹¶è¿”å›ä¸€ä¸ª â€œdoneâ€ å­—ç¬¦ä¸²ã€‚ è¿™æ˜¯ç”¨ Promise æ–¹å¼å®ç°ï¼š 12345678const makeRequest = () =&gt; getJSON() .then(data =&gt; &#123; console.log(data) return \"done\" &#125;)makeRequest() ç„¶åè¿™æ˜¯ç”¨ Async/Await æ–¹å¼å®ç°ï¼š 123456const makeRequest = async () =&gt; &#123; console.log(await getJSON()) return \"done\"&#125;makeRequest() è¿™é‡Œæœ‰å‡ ç‚¹ä¸åŒä¹‹å¤„ï¼š å‡½æ•°å‰é¢æœ‰ async å…³é”®å­—ã€‚await å…³é”®å­—åªèƒ½ç”¨åœ¨ç”± async å…³é”®å­—å®šä¹‰çš„å‡½æ•°é‡Œã€‚async å‡½æ•°ä¼šéšå¼çš„è¿”å›ä¸€ä¸ª Promiseï¼Œè¿™ä¸ª Promise çš„è§£æå€¼æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ &quot;done&quot; å­—ç¬¦ä¸²ï¼‰ã€‚ ä¸Šé¢æåˆ°çš„è¿™ç‚¹ä¹Ÿæš—ç¤ºäº†æˆ‘ä»¬ä¸èƒ½å°† await ç”¨åœ¨æˆ‘ä»¬ä»£ç çš„æœ€å¤–å±‚ï¼Œå› ä¸ºå®ƒå¿…é¡»è¢«æ”¾ç½®åœ¨ async å‡½æ•°å†…éƒ¨ã€‚ 1234567// this will not work in top level// await makeRequest()// this will workmakeRequest().then((result) =&gt; &#123; // do something&#125;) await getJSON() æ„æ€æ˜¯ console.log å°†ä¼šç­‰å¾… getJSON çš„ Promise è§£æå‡ºç»“æœï¼Œç„¶åæ‰æŠŠç»“æœæ‰“å°å‡ºæ¥ã€‚ å¥½åœ¨é‚£é‡Œå‘¢ï¼Ÿ ç®€æ´å¹²å‡€çœ‹æˆ‘ä»¬èŠ‚çœäº†å¤šå°‘ä»£ç ï¼å³ä½¿åœ¨æˆ‘ä»¬éšæ‰‹ç¼–çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œä¹Ÿèƒ½æ˜æ˜¾çš„çœ‹åˆ°çœäº†ä¸å°‘ä»£ç ã€‚æˆ‘ä»¬æ— éœ€å†å†™ .then ç„¶åç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°æ¥å¤„ç†è¿”å›å€¼ï¼Œä¹Ÿä¸éœ€è¦å®šä¹‰ä¸€ä¸ª data å˜é‡æ¥è¡¨ç¤ºè¿”å›å€¼ã€‚å¦å¤–æˆ‘ä»¬è¿˜é¿å…äº†ä»£ç åµŒå¥—ã€‚æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­æˆ‘ä»¬å°†æ›´æ˜æ˜¾çš„çœ‹åˆ°è¿™ä¸€ä¸ªä¸ªçš„ä¼˜ç‚¹å°†ç´¯ç§¯æˆå·¨å¤§çš„ä¼˜åŠ¿ã€‚ é”™è¯¯å¤„ç†Async/Await è®©æˆ‘ä»¬å¯ä»¥ç”¨æƒ¯ç”¨çš„ try/catch ç»“æ„æ¥å¤„ç†åŒæ­¥å’Œå¼‚æ­¥é”™è¯¯ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­æœ‰ä¸€ä¸ª Promiseï¼Œtry/catch æ— æ³•æ•è· JSON.parse äº§ç”Ÿçš„é”™è¯¯ï¼Œå› ä¸ºè¿™ä¸ªé”™è¯¯æ˜¯åœ¨ Promise å†…éƒ¨äº§ç”Ÿçš„ã€‚æˆ‘ä»¬éœ€è¦åœ¨ Promise ä¸Šè°ƒç”¨ .catch æ–¹æ³•å¹¶å¤åˆ¶ä¸€ä»½é”™è¯¯å¤„ç†çš„ä»£ç åˆ°è¿™é‡Œï¼Œåœ¨ä½ çš„ç”Ÿäº§ä»£ç ä¸­ï¼Œè¿™æ ·å†™åº”è¯¥ä¼šæ¯” console.log æ›´ç¨³å¦¥ä¸€äº›ã€‚ 12345678910111213141516const makeRequest = () =&gt; &#123; try &#123; getJSON() .then(result =&gt; &#123; // è¿™ä¸ªè§£æå°†ä¼šå¤±è´¥ const data = JSON.parse(result) console.log(data) &#125;) // å–æ¶ˆæ­¤å¤„æ³¨é‡Šä»¥å¤„ç†å¼‚æ­¥é”™è¯¯ // .catch((err) =&gt; &#123; // console.log(err) // &#125;) &#125; catch (err) &#123; console.log(err) &#125;&#125; ç°åœ¨æˆ‘ä»¬ç”¨ async/await æ¥å†™åŒæ ·çš„ä»£ç ã€‚ç°åœ¨ catch ä»£ç å°†èƒ½å¤Ÿå¤„ç†è§£æé”™è¯¯ã€‚ 123456789const makeRequest = async () =&gt; &#123; try &#123; // this parse may fail const data = JSON.parse(await getJSON()) console.log(data) &#125; catch (err) &#123; console.log(err) &#125;&#125; æ¡ä»¶è¯­å¥å‡è®¾ä¸‹é¢çš„ä»£ç å°†ä¼šè·å–ä¸€äº›æ•°æ®ï¼Œå¹¶æ ¹æ®æ•°æ®å†…å®¹å†³å®šæ˜¯è¦è¿”å›æ•°æ®è¿˜æ˜¯åŸºäºè·å–çš„å†…å®¹è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œã€‚ 123456789101112131415const makeRequest = () =&gt; &#123; return getJSON() .then(data =&gt; &#123; if (data.needsAnotherRequest) &#123; return makeAnotherRequest(data) .then(moreData =&gt; &#123; console.log(moreData) return moreData &#125;) &#125; else &#123; console.log(data) return data &#125; &#125;)&#125; å…‰æ˜¯çœ‹è¿™äº›ä»£ç å°±è®©äººå¤´ç–¼ã€‚è€Œä¸”è¿™ä¹ˆå¤šçš„åµŒå¥—ï¼ˆ6 å±‚ï¼‰ã€æ‹¬å·ã€ä»¥åŠä¸ºäº†æŠŠæœ€ç»ˆç»“æœä¼ é€’åˆ°ä¸» Promise çš„ return è¯­å¥å¾ˆå®¹æ˜“è®©äººæ™•å¤´è½¬å‘ã€‚ å½“æˆ‘ä»¬ç”¨ async/await é‡å†™è¿™ä¸ªä¾‹å­åï¼Œä»£ç åˆ™å˜å¾—éå¸¸æ˜“è¯»ã€‚ 1234567891011const makeRequest = async () =&gt; &#123; const data = await getJSON() if (data.needsAnotherRequest) &#123; const moreData = await makeAnotherRequest(data); console.log(moreData) return moreData &#125; else &#123; console.log(data) return data &#125;&#125; ä¸­é—´å€¼ä½ å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å½¢ï¼šè°ƒç”¨ Promise1 ç„¶åç”¨å®ƒçš„è¿”å›å€¼è°ƒç”¨ Promise2ï¼Œç„¶åå†ç”¨å®ƒä»¬ä¸¤ä¸ªçš„è¿”å›å€¼æ¥è°ƒç”¨ Promise3ã€‚ä½ çš„ä»£ç å¯èƒ½ä¼šåƒè¿™æ ·ï¼š 1234567891011const makeRequest = () =&gt; &#123; return promise1() .then(value1 =&gt; &#123; // do something return promise2(value1) .then(value2 =&gt; &#123; // do something return promise3(value1, value2) &#125;) &#125;)&#125; å¦‚æœ promise3 ä¸éœ€è¦ value1 é‚£ä¹ˆå°±å¯ä»¥å°† Promise åµŒå¥—å¼„çš„æ‰å¹³ä¸€äº›ã€‚è¦æ˜¯ä½ æ— æ³•æ¥å—è¿™ç§åšæ³•ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠ value1 å’Œ value2 éƒ½åŒ…åœ¨ä¸€ä¸ª Promise.all ä¸­æ¥é¿å…æ·±å±‚çš„åµŒå¥—ï¼Œåƒè¿™æ ·ï¼š 1234567891011const makeRequest = () =&gt; &#123; return promise1() .then(value1 =&gt; &#123; // do something return Promise.all([value1, promise2(value1)]) &#125;) .then(([value1, value2]) =&gt; &#123; // do something return promise3(value1, value2) &#125;)&#125; è¿™ç§æ–¹æ¡ˆä¸ºäº†å¯è¯»æ€§ç‰ºç‰²äº†éƒ¨åˆ†è¯­ä¹‰ã€‚å°† value1 å’Œ value2 æ”¾åœ¨åŒä¸€ä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†é¿å… Promise çš„åµŒå¥—ã€‚ ç”¨ async/await å®ç°åŒæ ·çš„é€»è¾‘å¼‚ä¹å¯»å¸¸çš„ç®€å•å’Œç›´è§‚ã€‚å®ƒè®©ä½ è´¨ç–‘è‡ªå·±é‚£äº›èŠ±åœ¨æ‹¼å‘½ä¼˜åŒ– Promise ä»£ç ä¸Šçš„æ—¶é—´æœ¬å¯ä»¥åšå¤šå°‘ç¾å¦™çš„äº‹æƒ…ã€‚ 12345const makeRequest = async () =&gt; &#123; const value1 = await promise1() const value2 = await promise2(value1) return promise3(value1, value2)&#125; é”™è¯¯å †æ ˆè®¾æƒ³æœ‰ä¸€æ®µé“¾å¼è°ƒç”¨å¤šä¸ª Promise çš„ä»£ç ï¼Œåœ¨é“¾çš„æŸä¸€éƒ¨åˆ†ï¼ŒæŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ã€‚ 1234567891011121314151617const makeRequest = () =&gt; &#123; return callAPromise() .then(() =&gt; callAPromise()) .then(() =&gt; callAPromise()) .then(() =&gt; callAPromise()) .then(() =&gt; callAPromise()) .then(() =&gt; &#123; throw new Error(\"oops\"); &#125;)&#125;makeRequest() .catch(err =&gt; &#123; console.log(err); // output // Error: oops at callAPromise.then.then.then.then.then (index.js:8:13) &#125;) Promise é“¾è¿”å›çš„é”™è¯¯çš„å †æ ˆæ²¡æœ‰ç»™å‡ºé”™è¯¯äº§ç”Ÿä½ç½®çš„ä¿¡æ¯ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå®ƒè¿˜æœ‰è¯¯å¯¼æ€§ï¼›å®ƒåŒ…å«çš„å”¯ä¸€ä¸€ä¸ªå‡½æ•°å callAPromise åœ¨è¿™é‡Œå®Œå…¨æ˜¯æ— è¾œçš„ï¼ˆä¸è¿‡æ–‡ä»¶åå’Œè¡Œå·è¿˜æ˜¯æœ‰ç”¨çš„ï¼‰ã€‚ ç›¸åï¼Œasync/await ç»™å‡ºçš„é”™è¯¯å †æ ˆæŒ‡å‡ºäº†çœŸæ­£åŒ…å«é”™è¯¯çš„å‡½æ•°ã€‚ 123456789101112131415const makeRequest = async () =&gt; &#123; await callAPromise() await callAPromise() await callAPromise() await callAPromise() await callAPromise() throw new Error(\"oops\");&#125;makeRequest() .catch(err =&gt; &#123; console.log(err); // output // Error: oops at makeRequest (index.js:7:9) &#125;) å½“ä½ å¼€ç€ç¼–è¾‘å™¨åœ¨æœ¬åœ°å†™ä»£ç æ—¶ï¼Œè¿™å¯èƒ½å½±å“ä¸å¤§ï¼Œä¸è¿‡å½“ä½ è¯•å›¾ä»ç”Ÿäº§æœåŠ¡å™¨åˆ†æé”™è¯¯æ—¥å¿—æ—¶ç”¨å¤„å°±å¤§äº†ã€‚è¿™æ—¶å€™ï¼ŒçŸ¥é“é”™è¯¯äº§ç”Ÿåœ¨ makeRequest è¦å¥½è¿‡çŸ¥é“é”™è¯¯å‘ç”Ÿåœ¨ä¸€ä¸ª then åçš„ then åçš„ then â€¦ è°ƒè¯•ç”¨ async/await çš„ä¸€ä¸ªæ€æ‰‹çº§ä¼˜åŠ¿æ˜¯è°ƒè¯•èµ·æ¥æ›´ç®€å•ã€‚ç”±äºä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼Œè°ƒè¯• Promise ä¸€ç›´æ˜¯ä¸ªç—›ç‚¹ï¼š è¿”å›å€¼æ˜¯è¡¨è¾¾å¼ï¼ˆæ²¡æœ‰å‡½æ•°ä½“ï¼‰çš„ç®­å¤´å‡½æ•°æ— æ³•è®¾ç½®æ–­ç‚¹ã€‚ å¦‚æœä½ åœ¨æŸä¸ª .then ä»£ç å—å†…éƒ¨è®¾ç½®æ–­ç‚¹ç„¶åä½¿ç”¨æ­¥è¿›è°ƒè¯•ï¼Œè°ƒè¯•å™¨ä¸ä¼šç§»åˆ°ä¸‹ä¸€ä¸ª .then ä¸­ï¼Œå› ä¸ºå®ƒåªèƒ½â€æ­¥è¿›â€œåŒæ­¥ä»£ç ã€‚ ä½¿ç”¨ async/await æ—¶ä¸éœ€è¦å¤ªä¾èµ–ç®­å¤´å‡½æ•°ï¼Œå¹¶ä¸”ä½ å¯ä»¥åƒè°ƒè¯•åŒæ­¥ä»£ç é‚£æ ·æ­¥è¿› await è°ƒç”¨ã€‚ ä½ å¯ä»¥ await ä¸€åˆ‡æœ€åçš„è¦ç‚¹ï¼Œawait åœ¨åŒæ­¥å’Œå¼‚æ­¥ä»£ç ä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚ä¾‹å¦‚ä½ å¯ä»¥å†™ await 5ï¼Œ ç›¸å½“äº `Promise.resolve(5)ã€‚ä¹çœ‹èµ·æ¥å¯èƒ½æ²¡å•¥ç”¨ï¼Œä½†æ˜¯åœ¨ä½ å†™å·¥å…·æˆ–åº“å‡½æ•°æ—¶ï¼Œç”¨äºå¤„ç†ä¸ç¡®å®šè¾“å…¥æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„æƒ…å†µæ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ å‡å¦‚ä½ æƒ³è®°å½•ä½ åº”ç”¨é‡ŒæŸä¸ª API æ‰§è¡Œçš„æ—¶é—´ï¼Œå¹¶å¸Œæœ›è¿™ä¸ªè®°å½•å‡½æ•°æ˜¯é€šç”¨çš„ã€‚ç”¨ Promise å®ç°å¦‚ä¸‹ï¼š 1234567const recordTime = (makeRequest) =&gt; &#123; const timeStart = Date.now(); makeRequest().then(() =&gt; &#123; // throws error for sync functions (.then is not a function) const timeEnd = Date.now(); console.log('time take:', timeEnd - timeStart); &#125;)&#125; æˆ‘ä»¬çŸ¥é“è¿™é‡Œæ‰€æœ‰çš„ API è°ƒç”¨éƒ½è¿”å› Promiseï¼Œä½†æ˜¯å¦‚æœä½ ç”¨è¿™ä¸ªå‡½æ•°å»è®°å½•ä¸€ä¸ªåŒæ­¥å‡½æ•°çš„æ‰§è¡Œæ—¶é—´å‘¢ï¼Ÿå®ƒå°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯å› ä¸ºåŒæ­¥å‡½æ•°ä¸è¿”å› Promiseã€‚ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„è§£å†³æ–¹æ³•æ˜¯æŠŠå‡½æ•°åŒ…è£¹åœ¨ Promise.resolve() ä¸­ã€‚ å¦‚æœä½¿ç”¨ async/awaitï¼Œä½ å°±æ— éœ€æ‹…å¿ƒä¸Šè¿°æƒ…å†µï¼Œå› ä¸º await è®©ä½ å®‰å…¨çš„å¤„ç†ä»»ä½•å€¼ï¼Œæ— è®ºæ˜¯å¦æ˜¯ Promiseã€‚ 123456const recordTime = async (makeRequest) =&gt; &#123; const timeStart = Date.now(); await makeRequest(); // works for any sync or async function const timeEnd = Date.now(); console.log('time take:', timeEnd - timeStart);&#125; ç»“è®ºAsync/Await æ˜¯è¿‘å¹´æ¥ JavaScript æ·»åŠ çš„é©å‘½æ€§çš„ç‰¹æ€§ä¹‹ä¸€ã€‚å®ƒè®©ä½ è®¤è¯†åˆ° Promise è¯­æ³•æ˜¯å¤šä¹ˆæ··ä¹±ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ›´ç›´è§‚çš„æ›¿ä»£æ–¹å¼ã€‚ ç–‘è™‘åœ¨ä½¿ç”¨ async/await æ—¶ä½ å¯èƒ½ä¼šæœ‰äº›ç–‘è™‘ï¼Œå› ä¸ºå®ƒè®©å¼‚æ­¥ä»£ç çš„ç‰¹å¾ä¸é‚£ä¹ˆæ˜æ˜¾äº†ï¼šä»¥å‰æˆ‘ä»¬ä¸€çœ‹åˆ° .then å›è°ƒå°±çŸ¥é“æ˜¯å¼‚æ­¥ä»£ç ï¼Œç°åœ¨å¯èƒ½éœ€è¦èŠ±å‡ å‘¨æ—¶é—´æ¥é€‚åº”æ–°çš„å†™æ³•ï¼Œä¸è¿‡ C# ä¸­å·²ç»å¼•å…¥è¿™ä¸ªç‰¹æ€§å¥½å‡ å¹´äº†ï¼Œäº†è§£å®ƒçš„äººéƒ½çŸ¥é“è¿™çŸ­æš‚çš„ä¸é€‚åº”æ˜¯å€¼å¾—çš„ã€‚ Follow me on twitter @imgaafar This article was originally published on Hackernoon","link":"/2019/09/09/6-reasons-async-await/"},{"title":"ã€Œè¯‘ã€ä½¿ç”¨ CSS ç¡¬ä»¶åŠ é€Ÿæå‡ç½‘ç«™æ€§èƒ½","text":"ä½œè€…ï¼š Guil Hernandez åŸæ–‡é“¾æ¥ï¼šIncrease Your Siteâ€™s Performance with Hardware-Accelerated CSS ä½ çŸ¥é“æˆ‘ä»¬å¯ä»¥æŠŠå›¾åƒç›¸å…³çš„ CSS ç‰¹æ€§äº¤ç»™ GPU(å›¾åƒå¤„ç†å•å…ƒ) å¤„ç†ï¼Œä»¥åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿåœ¨æµè§ˆå™¨ä¸­è·å¾—æ›´å¥½çš„æ¸²æŸ“æ€§èƒ½å—ï¼Ÿ å½“ä»Šçš„å¤§å¤šæ•°ç”µè„‘éƒ½æœ‰å¯ç”¨äºç¡¬ä»¶åŠ é€Ÿçš„æ˜¾å¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº› GPU èµ„æºå»å¤„ç†é‚£äº›æ¯”è¾ƒè€—æ€§èƒ½çš„ç‰¹æ€§ï¼Œè¿™æ ·æˆ‘ä»¬çš„ç½‘ç«™å’Œåº”ç”¨åœ¨æµè§ˆå™¨ä¸­å°±èƒ½è·å¾—æ¯”å•çº¯ç”¨ CPU å¤„ç†æ›´å¥½çš„æ€§èƒ½è¡¨ç°ã€‚ è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šè®²åˆ°æ¡Œé¢å’Œæ‰‹æœºç«¯æµè§ˆå™¨çš„ CSS ç¡¬ä»¶åŠ é€Ÿã€‚ æ¡Œé¢å’Œæ‰‹æœºç«¯æµè§ˆå™¨ä¸­çš„ CSS ç¡¬ä»¶åŠ é€Ÿä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆæœ‰äº› CSS åŠ¨ç”»åœ¨æµè§ˆå™¨ä¸­çœ‹èµ·æ¥æ¯”å…¶ä»–çš„æ›´æµç•…äº›ï¼Ÿ CSS animations, transforms å’Œ transitions é»˜è®¤å¹¶ä¸ä¼šå¯ç”¨ GPU åŠ é€Ÿï¼Œè€Œæ˜¯è¢«æµè§ˆå™¨å†…éƒ¨çš„ï¼ˆæ¯”è¾ƒæ…¢çš„ï¼‰è½¯ä»¶å¼•æ“æ¸²æŸ“ã€‚é‚£ä¹ˆåˆ°åº•æ˜¯ä»€ä¹ˆå¼ºåˆ¶æµè§ˆå™¨åˆ‡æ¢åˆ° GPU æ¨¡å¼å‘¢ï¼Ÿè®¸å¤šæµè§ˆå™¨é€šè¿‡ä¸€äº›ç‰¹å®šçš„ CSS è§„åˆ™å¯ç”¨ GPU åŠ é€Ÿã€‚ å½“å‰ï¼ŒChrome, Firefox, Safari, IE9+ å’Œæœ€æ–°ç‰ˆçš„ Opera éƒ½æ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼›å®ƒä»¬åªæœ‰åœ¨æ£€æµ‹åˆ°æŸä¸ª DOM å…ƒç´ å¯èƒ½ä¼šä»ä¸­è·ç›Šçš„æ—¶å€™æ‰ä¼šåº”ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚åœ¨ CSS ä¸­ï¼Œæœ€æ˜¾çœ¼çš„è¿¹è±¡å°±æ˜¯è¿™ä¸ªå…ƒç´ ä½¿ç”¨äº† 3D å˜æ¢ã€‚ ä¾‹å¦‚ï¼š 12345.cube &#123; -webkit-transform: translate3d(250px,250px,250px) rotate3d(250px,250px,250px,-120deg) scale3d(0.5, 0.5, 0.5);&#125; æŸäº›æ—¶å€™ï¼Œä½ å¯èƒ½å¹¶ä¸éœ€è¦ 3D å˜æ¢ä½†ä»ç„¶æƒ³åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ—¶å€™æœ‰å‡ ä¸ªéå¸¸é¡ºæ‰‹çš„ CSS ç‰¹æ€§å¯ä»¥ç”¨æ¥è§¦å‘æµè§ˆå™¨çš„ GPU åŠ é€Ÿã€‚ å°½ç®¡æˆ‘ä»¬çš„å…ƒç´ å¹¶ä¸æ˜¯åœ¨ 3D ç©ºé—´ä¸­åšåŠ¨ç”»ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å¯ç”¨ 3D æ¸²æŸ“ã€‚é—²è¯ä¼‘æï¼Œtransform: translateZ(0); å£°æ˜åœ¨æ¡Œé¢å’Œæ‰‹æœºç«¯æµè§ˆå™¨ä¸­éƒ½ä¼šè§¦å‘ GPU åŠ é€Ÿã€‚çœ‹èµ·æ¥è¿™æ˜¯è§¦å‘ GPU åŠ é€Ÿçš„æœ€æœ‰æ•ˆçš„æ–¹å¼äº†ï¼ˆæ·»åŠ äº†æ‰€æœ‰æµè§ˆå™¨å‰ç¼€ï¼‰ï¼š 12345678.cube &#123; -webkit-transform: translateZ(0); -moz-transform: translateZ(0); -ms-transform: translateZ(0); -o-transform: translateZ(0); transform: translateZ(0); /* Other transform properties here */&#125; åœ¨ Chrome å’Œ Safari ä¸­ä½¿ç”¨ CSS transforms æ—¶å¯èƒ½ä¼šæœ‰é—ªçƒã€‚ä¸‹é¢è¿™äº›å£°æ˜å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 123456789101112.cube &#123; -webkit-backface-visibility: hidden; -moz-backface-visibility: hidden; -ms-backface-visibility: hidden; backface-visibility: hidden; -webkit-perspective: 1000; -moz-perspective: 1000; -ms-perspective: 1000; perspective: 1000; /* Other transform properties here */&#125; å¦ä¸€ç§å¯ä»¥ç”¨åœ¨ Webkit å†…æ ¸çš„æ¡Œé¢å’Œæ‰‹æœºæµè§ˆå™¨ä¸­çš„æ–¹æ³•æ˜¯ä½¿ç”¨ translate3dï¼š 1234567.cube &#123; -webkit-transform: translate3d(0, 0, 0); -moz-transform: translate3d(0, 0, 0); -ms-transform: translate3d(0, 0, 0); transform: translate3d(0, 0, 0); /* Other transform properties here */&#125; åŸç”Ÿçš„æ‰‹æœºåº”ç”¨ä¸€ç›´åœ¨åˆ©ç”¨ GPU åŠ é€Ÿï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå¤§å®¶ä¸€ç›´ä»¥æ¥çš„å°è±¡éƒ½æ˜¯åŸç”Ÿåº”ç”¨è¦æ¯”ç½‘é¡µåº”ç”¨æ›´æµç•…ä¸€äº›ã€‚åœ¨æ‰‹æœºä¸Šä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿæ¥é™ä½èµ„æºæ¶ˆè€—æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚ ç»“è®ºæˆ‘ä»¬ä»‹ç»çš„è¿™äº›æ–¹æ³•åº”è¯¥åªç”¨äºéœ€è¦åŠ¨ç”»çš„å…ƒç´ ã€‚è¿™å¯ä»¥æé«˜ 2D å˜æ¢çš„æ€§èƒ½ï¼Œä¸è¿‡æŠŠè¿™ç§æ–¹æ³•ç”¨äºæ‰€æœ‰å…ƒç´ ç»ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ è°¨æ…ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œåªæœ‰å½“ä½ é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶æ‰éœ€è¦ç”¨å®ƒä»¬ã€‚æ»¥ç”¨ GPU åŠ é€Ÿå°†å¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºç¡¬ä»¶åŠ é€Ÿä¼šå ç”¨å¤§é‡å†…å­˜ -- è€Œä¸”è¿˜ä¼šå½±å“ç”µæ± ç»­èˆªã€‚ ä½ åœ¨ä½ çš„é¡¹ç›®ä¸­ç”¨è¿‡è¿™äº›æ–¹æ³•å—ï¼Ÿå¦‚æœç”¨è¿‡ï¼Œè¯·åˆ†äº«ä¸€ä¸‹å“ªäº›æ–¹æ³•æœ€æœ‰æ•ˆæ€§èƒ½æœ€å¥½ã€‚","link":"/2019/03/26/css-hardware-accelerate/"},{"title":"ã€Œè¯‘ã€å¦‚ä½•åˆ¶ä½œ SVG çº¿æ¡åŠ¨ç”»","text":"ä½œè€…ï¼šChris CoyieråŸæ–‡é“¾æ¥ï¼šWrite Your First Service Worker in 5 Minutes æˆ‘æ•¢è¯´ä½ ä»¬éƒ½è§è¿‡é‚£ç§çœ‹èµ·æ¥å¦‚åŒæ­£åœ¨å®æ—¶ç»˜åˆ¶ SVG å›¾å½¢çš„ SVG å°åŠ¨ç”»ã€‚æ•ˆæœéå¸¸çš„èµã€‚Jake Archibald æ˜¯è¿™é—¨æŠ€å·§çš„å…ˆé©±ï¼Œä»–è¿˜å†™äº†ä¸€ç¯‡è¶…çº§æ£’çš„å¼•äººå…¥èƒœçš„åšå®¢æ¥è¯´æ˜å¦‚ä½•å®ç°è¿™ç§æ•ˆæœã€‚Brian Suda ä¹Ÿåœ¨ 24 Ways ä¸Šé¢å†™äº†ä¸€ç¯‡æ–‡ç« ã€‚Polygon ä½¿ç”¨è¿™é¡¹æŠ€æœ¯æ¥ä¸ºä»–ä»¬çš„è®¾è®¡æ·»åŠ æƒŠè‰³çš„æ•ˆæœå¹¶å†™äº†ä¸€ç¯‡æ–‡ç« æ¥è¯´æ˜ã€‚Codrops ä¸Šæœ‰ä¸€äº›ç®€æ´çš„ä¾‹å­ã€‚ æˆ‘åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆå¯ä»¥å†è¡¥å……äº†ï¼Œåªä¸è¿‡æˆ‘çš„å¤§è„‘åˆšåˆšå¼„æ˜ç™½ï¼Œæ‰€ä»¥æˆ‘æƒ³å†è§£é‡Šä¸€éæˆ‘çš„ç†è§£ã€‚ 1. ä½ æœ‰ä¸€ä¸ª SVG å›¾å½¢ 2. å›¾å½¢å¿…é¡»æœ‰çº¿æ¡ï¼ˆstrokeï¼‰ 3. çº¿æ¡å¯ä»¥è¢«è®¾ç½®ç”Ÿæˆçº¿æ®µæ¨¡å¼æˆ‘ä»¬å¯ä»¥ç”¨ Illustrator å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼å®ç°ã€‚æˆ‘ä»¬ç”¨ CSS æ¥é€‰ä¸­å›¾å½¢è·¯å¾„ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬ç”¨çš„æ˜¯ inline SVG æˆ–è€…æ˜¯ä¸€ä¸ª &lt;object&gt; å…ƒç´ ï¼‰å¹¶åº”ç”¨çº¿æ®µæ ·å¼ã€‚ 123&lt;svg ...&gt; &lt;path class=\"path\" stroke=\"#000000\" ... &gt;&lt;/svg&gt; 123.path &#123; stroke-dasharray: 20;&#125; è¿™æ ·æˆ‘ä»¬å°±è®¾ç½®äº†é•¿åº¦ä¸º 20px çš„çº¿æ®µæ ·å¼ã€‚ 4. çº¿æ®µä¹Ÿå¯ä»¥è®¾ç½®çš„æ›´é•¿ä¸€ç‚¹â€¦123.path &#123; stroke-dasharray: 100;&#125; 5. æˆ‘ä»¬è¿˜å¯ä»¥ â€œoffsetâ€ è¿™äº›çº¿æ®µï¼Œä»¥ä¾¿è®©å®ƒä»¬ç§»åŠ¨ä½ç½®æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬æŠŠè¿™äº›çº¿æ®µçš„ offset åŠ¨ç”»ä»¥åçš„æ•ˆæœï¼š å®ç°èµ·æ¥å¾ˆç®€å• 12345678910.path &#123; stroke-dasharray: 100; animation: dash 5s linear;&#125;@keyframes dash &#123; to &#123; stroke-dashoffset: 1000; &#125;&#125; 6. è®¾æƒ³ä¸€ä¸‹å•ä¸ªçº¿æ®µé•¿åº¦è¶³ä»¥è¦†ç›–æ•´ä¸ªå›¾å½¢è¿™ä¸ªå°±ä¸ç”¨æ”¾å›¾äº†ï¼Œå®ƒçœ‹èµ·æ¥å°±æ˜¯å›¾å½¢æ²¡æœ‰çº¿æ®µåŒ–çš„æ ·å­ã€‚ä½ åªéœ€è¦æŠŠ stroke-dasharry è®¾ç½®æˆä¸€ä¸ªæ¯”æ•´ä¸ªå›¾å½¢æ›´é•¿çš„é•¿åº¦ã€‚ 7. ç°åœ¨ç»™çº¿æ¡è®¾ç½® offsetï¼Œè®©å®ƒå®Œå…¨æ¶ˆå¤±åœ¨å›¾å½¢èŒƒå›´å†…è€Œä¸æ˜¯è¦†ç›–æ•´ä¸ªå›¾å½¢ã€‚ç°åœ¨æ•´ä¸ªå›¾å½¢çœ‹èµ·æ¥ä»¿ä½›ä¸å­˜åœ¨ã€‚ 8. ç°åœ¨åŠ¨ç”» offset å±æ€§å¹¶å°†å®ƒè®¾ç½®ä¸º 0 å¦‚æœæ˜¯ä½¿ç”¨ CSSï¼Œä½ éœ€è¦å°† animation-fill-mode è®¾ç½®ä¸º forwardsï¼Œè¿™æ ·åŠ¨ç”»ç»“æŸæ—¶ä¼šä¿æŒåœ¨å®ŒæˆçŠ¶æ€ã€‚ 1234567891011.path &#123; stroke-dasharray: 1000; stroke-dashoffset: 1000; animation: dash 5s linear forwards;&#125;@keyframes dash &#123; to &#123; stroke-dashoffset: 0; &#125;&#125; é½æ´»å„¿ï¼ ä¸ºä»€ä¹ˆè¦ç”¨ JavaScriptï¼Ÿå¤§å¤šæ•°ä½ è§åˆ°çš„ SVG çº¿æ¡åŠ¨ç”»éƒ½ä½¿ç”¨äº† JavaScriptã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸€èˆ¬å¾ˆéš¾çŸ¥é“å›¾å½¢çš„å…·ä½“é•¿åº¦ã€‚æˆ‘ä»¬åœ¨ä¾‹å­ä¸­ä½¿ç”¨ 1000 æ˜¯å› ä¸ºè¿™åˆšå·§å°±æ˜¯å›¾å½¢çš„é•¿åº¦ã€‚ ä½ å¯ä»¥ç”¨ JavaScript è·å–å›¾å½¢é•¿åº¦ï¼š 12var path = document.querySelector('.path');var length = path.getTotalLength(); ç„¶åå°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„ä½¿ç”¨äº†ã€‚æœ¬æ–‡å¼€å¤´æåˆ°çš„é‚£äº›æ–‡ç« ä¸­æœ‰æ›´å¤šæ›´æ·±å…¥çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥å‚è€ƒé‚£äº›å†…å®¹å»å®ç°æ›´é…·ç‚«çš„æ•ˆæœã€‚è¿™é‡Œæˆ‘åªæ˜¯æ¦‚æ‹¬ä¸€äº›æ¦‚å¿µè¦ç‚¹ï¼Œæˆ–è®¸ä¹Ÿèƒ½å¸®åŠ©ä½ æ‚Ÿé€š SVG çº¿æ¡åŠ¨ç”»ã€‚","link":"/2020/01/30/svg-line-animation/"},{"title":"ã€Œè¯‘ã€5 åˆ†é’Ÿä¸Šæ‰‹ Service Worker","text":"ä½œè€…ï¼šCarmen BourlonåŸæ–‡é“¾æ¥ï¼šWrite Your First Service Worker in 5 Minutes ä»€ä¹ˆæ˜¯ Service Worker?Service Worker æ˜¯ä¸€ä¸ªè®©ä½ å¯ä»¥åœ¨ç”¨æˆ·æœºå™¨ä¸Šç¼“å­˜æ–‡ä»¶å’Œå…¶ä»–èµ„æºçš„å°æ–‡ä»¶ã€‚é‚£å®ƒè·ŸæœåŠ¡å™¨ç«¯ç¼“å­˜ (server-side caching) æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¿™ç§ç¼“å­˜æ˜¯æ”¾åœ¨ç”¨æˆ·çš„æœºå™¨ä¸Šçš„ï¼Œå› æ­¤è·ŸæœåŠ¡å™¨ç«¯çš„ç¼“å­˜ç›¸æ¯”ï¼Œå®ƒä¸éœ€è¦å†é€šè¿‡ç½‘ç»œä¼ è¾“ã€‚è¿™å¯¹æå‡ä½ çš„åº”ç”¨çš„é€Ÿåº¦å’Œå¯é æ€§æ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚ç”±äº app æ˜¯ä»ç¼“å­˜ä¸­è¿è¡Œçš„ï¼Œå°±ä¸ç”¨å¤§è´¹å‘¨ç« çš„èŠ±æ—¶é—´ä»ç½‘ç»œä¼ è¾“æ•°æ®äº†ã€‚ ä¸ºä»€ä¹ˆè¯´å®ƒå¯¹ä½ çš„åº”ç”¨æœ‰å¥½å¤„åº”ç”¨ Service Worker ä¸ä»…èƒ½æå‡åº”ç”¨çš„é€Ÿåº¦ï¼Œè¿˜èƒ½ä¸ºä½ çš„ç”¨æˆ·æä¾›å‰æ‰€æœªæœ‰çš„å¯é æ€§ã€‚ç”±äºä¸å†ä¾èµ–å®æ—¶çš„ç½‘ç»œè¿æ¥ï¼Œåº”ç”¨åœ¨ç½‘ç»œè´¨é‡å·®çš„æ—¶å€™ä¹Ÿèƒ½å·¥ä½œ--è¯´çœŸçš„æ‰€æœ‰äººçš„ç½‘ç»œè´¨é‡éƒ½ä¸å’‹çš„ã€‚ ç”Ÿå‘½å‘¨æœŸService Worker ç”Ÿå‘½å‘¨æœŸåŸºæœ¬æ˜¯è¿™æ ·ï¼š install Activate Fetch æˆ‘ä»¬æ¥åˆ†åˆ«è®²è§£ä¸€ä¸‹è¿™äº›äº‹ä»¶ï¼š Installåœ¨ install äº‹ä»¶ä¹‹å‰ï¼Œä½ çš„åº”ç”¨é‡Œè¿˜æ²¡æœ‰ Service Workerã€‚æµè§ˆå™¨ä¼šä»ä½ çš„ä»£ç ä¸­æ£€æµ‹æ³¨å†Œäº‹ä»¶å¹¶å®‰è£… Service Workerã€‚ä½ çš„ Service Worker åŒ…å«ä¸€ä¸ªåä¸º oninstall çš„å‡½æ•°ï¼Œå®ƒå°†å†³å®šå“ªäº›æ–‡ä»¶ä¼šè¢«ç¼“å­˜åˆ°ç”¨æˆ·çš„æœºå™¨ä¸Šã€‚ Activateåœ¨ Service Worker å®‰è£…å°±ç»ªä»¥åï¼Œä¼šè§¦å‘ activate äº‹ä»¶ã€‚æ­¤æ—¶æ˜¯æ¸…ç†è€æ—§æ— ç”¨çš„ç¼“å­˜æ–‡ä»¶çš„å¥½æ—¶æœºã€‚ä¸è¿‡åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šåœ¨ activate äº‹ä»¶é‡Œåšä»»ä½•æ“ä½œã€‚ Fetchè¿™æ˜¯æˆ‘ä»¬çš„ Service Worker å¤§æ˜¾èº«æ‰‹çš„æ—¶å€™ã€‚å½“åº”ç”¨å‘å‡º fetch è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬çš„ Service Worker ä¼šç”¨ä¸€ä¸ªåå­—ä¹Ÿæ˜¯ fetch çš„å‡½æ•°æ‹¦æˆªå®ƒã€‚ä½ çš„ Service Worker ä¼šä»æ¢ä»ä¸­å¯»æ‰¾ç±»ä¼¼çš„è¯·æ±‚æˆ–æ˜¯å°†è¿™ä¸ªè¯·æ±‚å‘é€å‡ºå»ã€‚ Service Worker ç”Ÿå‘½å‘¨æœŸä¸­ activate å’Œ fetch å¹¶ä¸æ˜¯ä¾æ¬¡æ‰§è¡Œçš„ã€‚Fetch åªæœ‰åœ¨æœ‰ fetch æ“ä½œæ—¶æ‰æ‰§è¡Œæ‹¦æˆªï¼Œå› æ­¤ activate äº‹ä»¶å’Œ ftech äº‹ä»¶ä¹‹é—´æ˜¯æœ‰é—´éš”çš„ã€‚åœ¨è¿™é—´éš”æœŸé—´ï¼ŒService Worker å¤„äºå¾…å‘½çŠ¶æ€ã€‚ Service Worker ç¤ºä¾‹æˆ‘ä»¬ç”¨ FayePI æ¥åšä¾‹å­ã€‚è¿™æ˜¯æˆ‘å†™çš„ä¸€ä¸ªå¸®åŠ©å¥³æ€§å­¦ä¹ å»ºè®¾åŠ¨æ€ç½‘ç«™çš„ APIï¼Œå®ƒçš„æ–‡æ¡£é¡µé¢ç”¨äº†ä¸€ç‚¹ç®€å•çš„ Service Workerã€‚ ä¸ºäº†å®‰è£… Service Workerï¼Œæˆ‘ä»¬å¾—å…ˆä¸ºåº”ç”¨æ·»åŠ ä¸€ä¸ªæ³¨å†Œå‡½æ•°ã€‚ 12345// index.jsif(navigator.serviceWorker) &#123; navigator.serviceWorker.register('serviceworker.js');&#125; ä¸Šé¢è¿™æ®µä»£ç é€šå¸¸æ”¾åœ¨ index.js ä¸­ä»¥ä¾¿åœ¨é¡µé¢åŠ è½½å®Œæˆåç«‹å³æ‰§è¡Œã€‚åœ¨ä½ çš„åº”ç”¨ä»£ç ä¸­ï¼Œè¿™æ˜¯å”¯ä¸€å¼•ç”¨ Service Worker çš„åœ°æ–¹ã€‚ ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ Service Worker æ–‡ä»¶ã€‚ 123456789// serviceworker.jsself.oninstall = function() &#123; caches.open('fayeFrontEndV1').then(function(cache) &#123; cache.addAll([ / ... / ]) .catch( / ... / ); &#125;) .catch( / ... /)&#125; è¿™äº›å°±æ˜¯å®‰è£… Sercice Worker æ—¶æ‰§è¡Œçš„ä»£ç ã€‚é¦–å…ˆæˆ‘ä»¬åˆå§‹åŒ–å¹¶æ‰“å¼€ cacheã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå°†æ–‡ä»¶ç¼“å­˜åˆ°ç”¨æˆ·æœºå™¨ä¸Šã€‚ caches.open è¿”å›ä¸€ä¸ªåŒ…å«æˆ‘ä»¬æ‰“å¼€çš„ cache çš„å¼•ç”¨çš„ promiseã€‚ç„¶åæˆ‘ä»¬ä¼ ç»™ addAll å‡½æ•°ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚è¿™äº›å­—ç¬¦ä¸²æ˜¯æˆ‘ä»¬è¦æ·»åŠ åˆ°ç¼“å­˜çš„æ–‡ä»¶çš„è·¯å¾„ã€‚æœ€åæˆ‘ä»¬æ·»åŠ å‡ ä¸ª catch å‡½æ•°æ¥å¤„ç†å¯èƒ½ä¼šå‡ºç°çš„é”™è¯¯ã€‚ ä¸‹ä¸€æ­¥æ˜¯ activate: 1234// serviceworker.jsself.onactivate = function(event) &#123; console.log('sw is up and running!');&#125; æ­¤æ—¶æ˜¯è¿›è¡Œåƒåœ¾æ¸…ç†çš„å¥½æ—¶æœºï¼Œä¸è¿‡æˆ‘ä»¬å°†åœ¨å¦ä¸€ç¯‡åšæ–‡é‡Œè®²è§£ã€‚ æœ€åï¼Œä¹Ÿæ˜¯æœ€æ£’çš„éƒ¨åˆ†ï¼è®©æˆ‘ä»¬æ¥çœ‹çœ‹ fetchã€‚ 12345678910111213// serviceworker.jsself.onfetch = function(event) &#123; event.respondWith( caches.match(event.request) .then(function(cachedFiles) &#123; if(cachedFiles) &#123; return cachedFiles; &#125; else &#123; return fetch(event.request); &#125; &#125;) );&#125; è¿™ä¸ªå‡½æ•°ä¼šåœ¨ Service Worker æ£€æµ‹åˆ° fetch è¯·æ±‚æ—¶æ‰§è¡Œã€‚å®ƒä¼šåœ¨å…¨éƒ¨ cache ä¸­è¯•å›¾æ‰¾åˆ°åŒ¹é…çš„è¯·æ±‚ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œå‡½æ•°å°†è¿”å› cache ä¸­çš„ç»“æœã€‚å¦åˆ™ Service Worker ä¼šå‘é€ç½‘ç»œè¯·æ±‚ã€‚ è®©æˆ‘ä»¬ä»”ç»†åˆ†æä¸€ä¸‹ event.respondWith å’Œ caches.matchï¼Œè¿™ä¿©éƒ½æ˜¯ Service Worker ä¸“æœ‰çš„ã€‚ event.respondWith è®©ä½ å¯ä»¥æ‰“æ–­ fetch è¯·æ±‚å¹¶è¿”å›ä½ è‡ªå·±çš„å“åº”å†…å®¹ã€‚ä¸€å®šè¦æ³¨æ„å¿…é¡»ç”¨è¿™ä¸ªæ–¹æ³•è€Œä¸æ˜¯ç®€å•çš„ return ä¸€ä¸ªè¿”å›å€¼ï¼Œåªæœ‰è¿™æ ·ä½ æ‹¦æˆªçš„å›å¤æ‰èƒ½å‘é€åˆ°æ­£ç¡®çš„åœ°æ–¹ã€‚ caches.match è®©ä½ èƒ½å¤Ÿæœç´¢ CacheStorage å¹¶æ‰¾åˆ°è¯·æ±‚çš„åŒ¹é…é¡¹ã€‚æˆ‘ä»¬å‘ cache æ·»åŠ çš„å†…å®¹ï¼Œä¼šè¢«å­˜å‚¨åˆ°ä¸€ä¸ªæ ˆä¸­ï¼Œæœ€æ—©æ·»åŠ çš„åœ¨æœ€åº•éƒ¨ï¼Œæœ€åæ·»åŠ çš„åœ¨é¡¶éƒ¨ã€‚caches.match ä¼šè¿”å›æœ€æ–°çš„åŒ¹é…é¡¹ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™è¿”å› nullã€‚ å¤§åŠŸå‘Šæˆï¼ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ Service Worker çš„å…¨éƒ¨å†…å®¹ï¼å¦‚æœä½ è§‰å¾— Service Worker è¶…çº§é…·ï¼Œæˆ‘æ¨èä½ äº†è§£ä¸€ä¸‹å®ƒè¿˜èƒ½åšä»€ä¹ˆï¼ŒåŒ…æ‹¬åå° fetchï¼Œåœ¨è¿™ç¯‡åšå®¢ä¸­ã€‚ å¦‚æœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äº Service Worker çš„çŸ¥è¯†ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å» serviceworkerbook.com å¹¶è®¢é˜…æˆ‘çš„é‚®ä»¶åˆ—è¡¨ï¼Œå¹¶åœ¨ Twitter å…³æ³¨æˆ‘ï¼ä½ ä¼šåœ¨æˆ‘çš„ä¹¦ â€œLetâ€™s Take This Offlineâ€ å‡ºç‰ˆçš„ç¬¬ä¸€æ—¶é—´è·æ‚‰ï¼","link":"/2019/03/31/sw-in-5m/"},{"title":"ã€Œè¯‘ã€Web Componentsï¼šå…¥é—¨åˆ°ç²¾é€š (1)","text":"ä½œè€…ï¼šPascal SchilpåŸæ–‡é“¾æ¥ï¼šWeb Components: from zero to hero Web Components: å…¥é—¨åˆ°ç²¾é€šä¸€ä¸ªç¼–å†™åŸç”Ÿ Web Components çš„æ•™ç¨‹ ä»€ä¹ˆæ˜¯ Web Componentsï¼Ÿ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ ç¼–å†™æˆ‘ä»¬çš„ to-do åº”ç”¨ è®¾ç½® properties è®¾ç½® attributes å°† properties æ˜ å°„åˆ° attributes äº‹ä»¶ æµè§ˆå™¨æ”¯æŒä»¥åŠ polyfill åŒ…è£… Web Components ç°åœ¨æœ‰äº†è¶Šæ¥è¶Šå¤§çš„æ¨åŠ¨åŠ›ã€‚éšç€ Edge å›¢é˜Ÿå®£å¸ƒéƒ¨ç½² Custom Elements å’Œ Shadow DOMï¼Œæ‰€æœ‰çš„ä¸»æµæµè§ˆå™¨éƒ½å·²ç»åŸç”Ÿæ”¯æŒ Web Componentsã€‚åƒ Githubï¼ŒNetflixï¼ŒYoutube å’Œ ING ç­‰ç”šè‡³å·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨äº† Web Componentsï¼èµï¼ä¸è¿‡ï¼Œå¾ˆè®©äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™äº›æˆåŠŸçš„å¤§å…¬å¸ä¸­æ²¡æœ‰ä¸€ä¸ªåšè¿‡ï¼ˆçŒœçš„æ²¡é”™ï¼‰ to-do åº”ç”¨ï¼ å› æ­¤ï¼Œä»Šå¤©æˆ‘ä»¬è¦åšä¸€ä¸ª to-do åº”ç”¨ï¼Œå› ä¸ºä¸–ç•Œä¸Šè¿˜æ²¡å‡ ä¸ª to-do åº”ç”¨ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œå…ˆé¢„è§ˆä¸€ä¸‹æˆ‘ä»¬è¦åšçš„ä¸œè¥¿ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘è¦å…ˆå†™ç‚¹å…è´£å£°æ˜ï¼Œè¿™ç¯‡åšæ–‡åªæ˜¯ä¸ºäº†è®©ä½ å¯¹ Web Components çš„åŸºç¡€æ¦‚å¿µæœ‰ä¸ªå¤§æ¦‚çš„äº†è§£ã€‚Web Components æ˜¯éå¸¸åº•å±‚çš„æŠ€æœ¯ï¼Œå¹¶ä¸å»ºè®®åœ¨æ²¡æœ‰è¾…åŠ©åº“çš„æƒ…å†µä¸‹ç¼–å†™å®Œæ•´çš„åº”ç”¨ï¼Œä¹Ÿä¸åº”è¯¥æ‹¿å®ƒè·Ÿå…¶ä»–æˆç†Ÿçš„æ¡†æ¶è¿›è¡Œæ¯”è¾ƒã€‚ ä»€ä¹ˆæ˜¯ Web Componentsï¼Ÿå…ˆè¯´é‡ç‚¹ï¼šWeb Components æ˜¯ä¸€ç³»åˆ—ç¼–å†™å…·æœ‰æ¨¡å—åŒ–ã€å¯é‡ç”¨å’Œå°è£…æ€§çš„ HTML å…ƒç´ çš„è§„èŒƒã€‚æœ€æ£’çš„åœ°æ–¹åœ¨äºï¼šç”±äºå®ƒæ˜¯åŸºäº web æ ‡å‡†ï¼Œæˆ‘ä»¬æ— éœ€å®‰è£…ä»»ä½•æ¡†æ¶æˆ–åº“ã€‚ç°åœ¨ä½ å°±å¯ä»¥ç”¨çº¯ JavaScript ç¼–å†™ Web Componentsï¼ ä¸è¿‡å‘¢ï¼Œåœ¨æˆ‘ä»¬ä¸‹æ‰‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç¼–å†™ Web Components çš„å¿å®˜è§„èŒƒã€‚ è‡ªå®šä¹‰å…ƒç´ Custom Elements api å…è®¸æˆ‘ä»¬ç¼–å†™è‡ªå®šä¹‰çš„ DOM å…ƒç´ ã€‚é€šè¿‡è¿™ä¸ª apiï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ ï¼Œå¹¶é€šçŸ¥è§£æå™¨å¦‚ä½•æ­£ç¡®çš„æ„å»ºå…ƒç´ åŠå¦‚ä½•åº”å¯¹æ­¤ç±»å…ƒç´ çš„å˜åŠ¨ã€‚ä½ æ˜¯å¦æƒ³è¿‡åˆ›å»ºè‡ªå·±çš„å…ƒç´ ï¼Œæ¯”å¦‚ &lt;my-cool-element&gt;ï¼Ÿç°åœ¨ä½ èƒ½å¤Ÿè¿™æ ·åšäº†ï¼ Shadow DOMShadow DOM ç»™äº†æˆ‘ä»¬å°è£…ç»„ä»¶æ ·å¼å’Œæ ‡è®°çš„èƒ½åŠ›ã€‚å®ƒæ˜¯ä¸€ä¸ª DOM å…ƒç´ çš„å­ DOM æ ‘ï¼Œå¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„ç»„ä»¶æ ·å¼ä¸ä¼šæ³„æ¼åˆ°å¤–éƒ¨ä½œç”¨åŸŸï¼Œæˆ–æ˜¯è¢«å¤–éƒ¨ä½œç”¨åŸŸçš„æ ·å¼æ‰€å½±å“ã€‚æ˜¯æ¨¡å—åŒ–çš„ç»é…ã€‚ ES æ¨¡å—ES æ¨¡å—è§„èŒƒå®šä¹‰äº†æ ‡å‡†åŒ–ã€æ¨¡å—åŒ–ã€é«˜æ•ˆç‡çš„å¼•ç”¨å’Œé‡ç”¨ JS æ–‡ä»¶çš„æ–¹å¼ã€‚ HTML TemplatesHTML &lt;template&gt; æ ‡ç­¾å…è®¸æˆ‘ä»¬åˆ›å»ºå¯é‡ç”¨çš„ DOM å—ã€‚åœ¨ template å†…éƒ¨ï¼Œè„šæœ¬ä¸ä¼šæ‰§è¡Œï¼Œå›¾ç‰‡ä¸ä¼šåŠ è½½ï¼Œæ ·å¼å’Œæ ‡ç­¾ä¹Ÿä¸ä¼šæ¸²æŸ“ã€‚åœ¨è¿™ä¸ª template è¢«æ¿€æ´»ä¹‹å‰å®ƒç”šè‡³ä¼šè¢«å½“ä½œä¸å­˜åœ¨åœ¨ document ä¸­ã€‚HTML templates éå¸¸æ£’ï¼Œå› ä¸ºä¸ç®¡æˆ‘ä»¬è¿™ä¸ªè‡ªå®šä¹‰å…ƒç´ æœ‰å¤šå°‘å®ä¾‹ï¼Œå®ƒä»¬ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ª templateã€‚ ç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“äº† Web Components åˆ©ç”¨äº†å“ªäº› Web è§„èŒƒï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è‡ªå®šä¹‰å…ƒç´ çš„ç”Ÿå‘½å‘¨æœŸã€‚åˆ«æ€¥ï¼Œåˆ«æ€¥ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±è¦å¼€å§‹å†™ä»£ç äº†ï¼ ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è‡ªå®šä¹‰å…ƒç´ çš„ç”Ÿå‘½å‘¨æœŸã€‚ä»¥ä¸‹é¢çš„å…ƒç´ ä¸ºä¾‹ï¼š 12345678910111213141516171819202122232425class MyElement extends HTMLElement &#123; constructor() &#123; // åŠ¡å¿…å…ˆè°ƒç”¨ super() super(); console.log('constructed!'); &#125; connectedCallback() &#123; console.log('connected!'); &#125; disconnectedCallback() &#123; console.log('disconnected!'); &#125; attributeChangedCallback(name, oldVal, newVal) &#123; console.log(`Attribute: $&#123;name&#125; changed!`); &#125; adoptedCallback() &#123; console.log('adopted!'); &#125;&#125;window.customElements.define('my-element', MyElement); constructor()constructor ä¼šåœ¨å…ƒç´ åˆ›å»ºåè€Œå°šæœªè¢«é™„åŠ åˆ°æ–‡æ¡£ä¸Šä¹‹å‰è¢«è°ƒç”¨ã€‚æˆ‘ä»¬ç”¨ constructor æ¥è®¾ç½®åˆå§‹çŠ¶æ€ã€äº‹ä»¶ç›‘å¬ä»¥åŠ shadow DOMã€‚ connectCallback()connectCallback ä¼šåœ¨å…ƒç´ è¢«æ·»åŠ åˆ° DOM ä¸­åè¢«è°ƒç”¨ã€‚æ­¤æ—¶éå¸¸é€‚åˆæ‰§è¡Œåˆå§‹åŒ–ä»£ç ï¼Œæ¯”å¦‚è·å–æ•°æ®æˆ–æ˜¯è®¾ç½®é»˜è®¤å±æ€§ã€‚ disconnectedCallback()disconnectedCallback() ä¼šåœ¨å…ƒç´ ä» DOM ä¸­è¢«ç§»é™¤åè°ƒç”¨ã€‚å¤§æ‰«é™¤æ—¶é—´ï¼æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ disconnectedCallback æ¥ç§»é™¤äº‹ä»¶ç›‘å¬å™¨æˆ–å–æ¶ˆå®šæ—¶å¾ªç¯äº‹ä»¶ã€‚ attributeChangedCallback(name, oldValue, newBalue)attributeChangedCallback ä¼šåœ¨å…ƒç´ çš„å—ç›‘çš„æ§å±æ€§å˜åŠ¨æ—¶è¢«è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® observedAttributes getter æ¥ç›‘æ§æŸä¸ªå…ƒç´ å±æ€§ï¼Œåƒè¿™æ ·ï¼š 123static get observedAttributes() &#123; return ['my-attr'];&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯å½“ my-attr å±æ€§å‘ç”Ÿå˜åŒ–ï¼ŒattributeChangedCallback å°±ä¼šæ‰§è¡Œã€‚æœ¬æ–‡åé¢å°†ä¼šè¯¦ç»†è®²è§£ã€‚","link":"/2019/04/01/web-components-hero-1/"},{"title":"ã€Œè¯‘ã€æ·±åº¦ç†è§£ JavaScript ES6 ä¸­çš„ â€œSuperâ€ å’Œ â€œExtendsâ€","text":"ä½œè€…ï¼šAnurag MajumdaråŸæ–‡é“¾æ¥ï¼šâ€œSuperâ€ and â€œExtendsâ€ In JavaScript ES6 - Understanding The Tough Parts ES6 çš„ class è¯­æ³•ä»¥åŠå…¶ä»–æ–°ç‰¹æ€§è®© JavaScript æ˜¾å¾—ç®€å•å¤šäº†ã€‚ä»Šå¤©æˆ‘ä»¬å°†ç»“åˆ class è¯­æ³•å’Œç»§æ‰¿æ¦‚å¿µæ¥åˆ†æä¸€äº›ä»£ç ã€‚çŒœçš„æ²¡é”™ï¼Œæˆ‘ä»¬è¦ç ”ç©¶çš„æ­£æ˜¯ ES6 ä¸­çš„ super å’Œ extends å…³é”®å­—ã€‚å­¦ä¹ æ–°ç‰¹æ€§æœ€å¥½çš„æ–¹å¼å°±æ˜¯åœ¨å®ä¾‹ä¸­æ·±å…¥çš„ç ”ç©¶å®ƒã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼ åœ¨ä»£ç ä¸­ä½¿ç”¨ super å’Œ extendsæˆ‘ä»¬å¯ä»¥å€ŸåŠ© super å’Œ extends JavaScript ä¸­æ‰©å±•ä¸€ä¸ª classã€‚æ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªå…³é”®å­—çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758class Animal &#123; constructor(name, weight) &#123; this.name = name; this.weight = weight; &#125; eat() &#123; return `$&#123;this.name&#125; is eating!`; &#125; sleep() &#123; return `$&#123;this.name&#125; is going to sleep!`; &#125; wakeUp() &#123; return `$&#123;this.name&#125; is waking up!`; &#125;&#125;class Gorilla extends Animal &#123; constructor(name, weight) &#123; super(name, weight); &#125; climbTrees() &#123; return `$&#123;this.name&#125; is climbing trees!`; &#125; poundChest() &#123; return `$&#123;this.name&#125; is pounding its chest!`; &#125; showVigour() &#123; return `$&#123;super.eat()&#125; $&#123;this.poundChest()&#125;`; &#125; dailyRoutine() &#123; return `$&#123;super.wakeUp()&#125; $&#123;this.poundChest()&#125; $&#123;super.eat()&#125; $&#123;super.sleep()&#125;`; &#125;&#125;function display(content) &#123; console.log(content);&#125;const gorilla = new Gorilla('George', '160Kg');display(gorilla.poundChest());display(gorilla.sleep());display(gorilla.showVigour());display(gorilla.dailyRoutine());// OUTPUT:// George is pounding its chest!// George is going to sleep!// George is eating! George is pounding its chest!// George is waking up! George is pounding its chest! George is eating! George is going to sleep! ES6 Class åŠ Subclass è¯­æ³• ä¸Šé¢çš„ä»£ç ä¸­æœ‰ä¸¤ä¸ª JavaScript classï¼Œåˆ†åˆ«å«åš Animal å’Œ Gorillaã€‚ Gorilla class é€šè¿‡ä½¿ç”¨ extends å…³é”®å­—å°†è‡ªå·±è®¾ç½®ä¸º Animal class çš„é™„å±ç±»ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºå­ç±»ã€‚ ä¸è¿‡ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œsuper å…³é”®å­—åœ¨è¿™é‡Œæœ‰ä¸¤ç§ä¸åŒçš„ç”¨æ³•ã€‚åœ¨ Gorilla æ„é€ å‡½æ•°ä¸­ï¼ˆä»£ç  23 è¡Œï¼‰ï¼Œsuper è¢«å½“ä½œæ–¹æ³•ä½¿ç”¨ï¼Œç„¶è€Œåœ¨ Gorilla çš„ showVigour() æ–¹æ³•ï¼ˆä»£ç  35 è¡Œï¼‰åŠ dailyRoutine() æ–¹æ³•ï¼ˆä»£ç  39 è¡Œï¼‰ä¸­ super å´æ˜¯è¢«å½“ä½œâ€œå¯¹è±¡â€ä½¿ç”¨çš„ã€‚ super å…³é”®å­—æœ‰ä¸¤ç§ä¸åŒç”¨æ³•çš„åŸå› æ˜¯ï¼šåœ¨ç¬¬ 23 è¡Œä¸­ï¼Œsuper å…³é”®å­—æ˜¯ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½¿ç”¨ä¼ é€’ç»™ Gorilla çš„å‚æ•°æ¥è°ƒç”¨çˆ¶ç±» Animalã€‚è¿™æ˜¯ç¡®ä¿ Gorilla æ˜¯ Animal çš„å®ä¾‹çš„å…³é”®ä¸€æ­¥ã€‚åœ¨ç¬¬ 35 è¡Œå’Œç¬¬ 39 è¡Œä¸­ï¼ŒSuper è¢«ç”¨ä½œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ¥å¼•ç”¨ä¸€ä¸ª Animal å®ä¾‹ï¼ˆçˆ¶ç±»ï¼‰ã€‚è¿™é‡Œçš„ super å…³é”®å­—ç”¨æ¥æ˜¾å¼çš„è°ƒç”¨çˆ¶ç±» Animal çš„æ–¹æ³•ã€‚ ç†Ÿæ‚‰ C#ã€JAVAã€Python ç­‰è¯­è¨€çš„äººåº”è¯¥èƒ½æ˜ç™½è¿™æ˜¯æ€ä¹ˆå›äº‹ã€‚ä¸è¿‡ï¼Œåœ¨ ES6 å‡ºç°ä¹‹å‰ JavaScript å¯æ²¡è¿™ä¹ˆç®€æ˜ï¼Œç‰¹åˆ«æ˜¯åœ¨ç±»è¿™ä¸ªé—®é¢˜ä¸Šã€‚é‚£ä¹ˆåœ¨æ²¡æœ‰ class è¯­æ³•ã€super åŠ extends å…³é”®å­—çš„å¹´ä»£äººä»¬æ˜¯æ€ä¹ˆå†™ä»£ç çš„å‘¢ï¼Ÿè¿˜æ˜¯è¿™ç¾¤ä»æœªç”¨è¿‡ä»¥ä¸Šæ¦‚å¿µçš„äººçªå‘å¥‡æƒ³çš„è¦æ·»åŠ è¿™äº›ç‰¹æ€§ï¼Ÿè®©æˆ‘ä»¬æ¥æ¢å¯»ä¸€ä¸‹ï¼ ä¼ ç»Ÿçš„ JavaScript ç±»äº‹å®ä¸Šï¼Œé¢å‘å¯¹è±¡çš„ JavaScript ä½¿ç”¨åŸå‹ç»§æ‰¿æ¥æ‰©å±•ç±»ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç”¨ä¼ ç»Ÿçš„ JavaScript è¯­æ³•æ¥å†™ä¸Šé¢çš„ä¾‹å­ã€‚ä¹Ÿè®¸è¿™å°†å¸®ä½ æ‰¾åˆ°éšè—çš„çœŸç›¸ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556function Animal(name, weight) &#123; this.name = name; this.weight = weight;&#125;Animal.prototype.eat = function() &#123; return `$&#123;this.name&#125; is eating!`;&#125;Animal.prototype.sleep = function() &#123; return `$&#123;this.name&#125; is going to sleep!`;&#125;Animal.prototype.wakeUp = function() &#123; return `$&#123;this.name&#125; is waking up!`;&#125;function Gorilla(name, weight) &#123; Animal.call(this, name, weight);&#125;Gorilla.prototype = Object.create(Animal.prototype);Gorilla.prototype.constructor = Gorilla;Gorilla.prototype.climbTrees = function () &#123; return `$&#123;this.name&#125; is climbing trees!`;&#125;Gorilla.prototype.poundChest = function() &#123; return `$&#123;this.name&#125; is pounding its chest!`;&#125;Gorilla.prototype.showVigour = function () &#123; return `$&#123;Animal.prototype.eat.call(this)&#125; $&#123;this.poundChest()&#125;`;&#125;Gorilla.prototype.dailyRoutine = function() &#123; return `$&#123;Animal.prototype.wakeUp.call(this)&#125; $&#123;this.poundChest()&#125; $&#123;Animal.prototype.eat.call(this)&#125; $&#123;Animal.prototype.sleep.call(this)&#125;`;&#125;function display(content) &#123; console.log(content);&#125;var gorilla = new Gorilla('George', '160Kg');display(gorilla.poundChest());display(gorilla.sleep());display(gorilla.showVigour());display(gorilla.dailyRoutine());// OUTPUT:// George is pounding its chest!// George is going to sleep!// George is eating! George is pounding its chest!// George is waking up! George is pounding its chest! George is eating! George is going to sleep! ES6 å‡ºç°ä¹‹å‰é¢å‘å¯¹è±¡çš„ JavaScript çœ‹å®Œä¸Šé¢çš„ä»£ç ä»¥åä½ ä»¬ä¸€å®šåœ¨æƒ³ï¼Œç­‰ä¸€ä¸‹ï¼Œè¿™é‡Œé¢æ€ä¹ˆæ²¡æœ‰ classï¼Ÿä¹Ÿæ²¡æœ‰ constructorï¼Ÿè¿™äº›å¤è€çš„ JavaScript ä»£ç æ˜¯å¦‚ä½•åšåˆ°åœ¨ä¸ä½¿ç”¨ extends å’Œ super å…³é”®å­—çš„æƒ…å†µä¸‹å®ç°ç»§æ‰¿çš„ï¼Ÿè¿™æ ·å†™ä»£ç ä¸æ˜¯å¾ˆä¸‘å˜›ï¼Ÿ æ²¡é”™å„¿æˆ‘å®Œå…¨ç†è§£ä½ ä»¬çš„æ„Ÿå—ã€‚å¾ˆä¸å¹¸ï¼ŒJavaScript çš„åº•å±‚å®ç°ä»æœªå˜è¿‡ã€‚ä¸ç®¡æœ‰å¤šå°‘æ–°ç‰¹æ€§è¢«æ·»åŠ ï¼Œå®ƒçš„åº•å±‚ä»ç„¶æ˜¯è€æ ·å­ã€‚classã€constructorã€super å’Œ extends ç­‰å…³é”®å­—åªæ˜¯ä¸ºä»–æ·»åŠ äº†ä¸€äº›è¯­æ³•ç³–ï¼Œä»¥ä½¿å¾—ä»£ç å¯è¯»æ€§æ›´å¥½ä¹Ÿæ›´æ˜“äºç¼–å†™ã€‚ è®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ ES6 å“ªäº›ä»£ç å¯¹åº”äº†ä¼ ç»Ÿçš„ JavaScript ä»£ç ã€‚ å¦‚æœä½ æ˜¯åˆæ¬¡æ¥è§¦ JavaScript ä¸­çš„ prototype å’Œ inheritance æ¦‚å¿µï¼Œè¯·å…ˆé˜…è¯»ä¸‹é¢ä¸¤ç¯‡æ–‡ç« åå†ç»§ç»­é˜…è¯»æœ¬æ–‡å‰©ä¸‹çš„ç« èŠ‚ï¼š è¿™ä¸¤ç¯‡å‚è€ƒæ–‡ç« å¯¹ä½ æ›´å¥½çš„ç†è§£ä¸‹é¢çš„ç« èŠ‚ä¼šæœ‰å¾ˆå¤§å¸®åŠ©ã€‚ ES6 ä¸ä¼ ç»Ÿ JavaScript ä»£ç å¯¹æ¯”ä¸‹é¢çš„ç« èŠ‚å›åˆ†è§£å¯¹æ¯” ES6 ä»£ç ä¸ä¼ ç»Ÿ JavaScript é£æ ¼ä»£ç çš„å¼‚åŒã€‚ ç±»å£°æ˜ä¸‹é¢çš„ä»£ç ç‰‡æ®µå¯¹æ¯”äº†ä¸¤ç§ç±»å£°æ˜æ–¹å¼ã€‚ 1234567891011121314151617// ES6 styleclass Animal &#123; constructor(name, weight) &#123; this.name = name; this.weight = weight; &#125; //...&#125;// Check Type of ES6 classtypeof Animal // function// Traditional stylefunction Animal(name, weight) &#123; this.name = name; this.weight = weight;&#125; ç±»å£°æ˜å¯¹æ¯” ES6 çš„ç±»å£°æ˜ç›´æ¥ä½¿ç”¨ class å…³é”®å­—ï¼Œç„¶ååœ¨ constructor ï¼ˆæ„é€ å‡½æ•°ï¼‰ä¸­å®šä¹‰å®ä¾‹å˜é‡ã€‚è€Œåœ¨ä¼ ç»Ÿçš„ JavaScript ä¸­æ˜¯æ²¡æœ‰ class è¿™ç§ä¸œè¥¿çš„ã€‚å®é™…ä¸Šåœ¨ JavaScript å†…éƒ¨ class å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆå‚è§ä»£ç ç‰‡æ®µç¬¬ 11 è¡Œï¼‰ã€‚ ç¬¬ 3 è¡Œçš„ constructor å‡½æ•°è·Ÿç¬¬ 14 è¡Œçš„å‡½æ•°æ˜¯ä¸€æ ·çš„ã€‚è¿™é‡Œçš„ Animal å‡½æ•°å°±ç›¸å½“äº constructor å‡½æ•°ã€‚ Class ä¸­çš„æ–¹æ³•12345678910111213141516171819202122232425// ES6 styleclass Animal &#123; // ... eat() &#123; return `$&#123;this.name&#125; is eating!`; &#125; sleep() &#123; return `$&#123;this.name&#125; is going to sleep!`; &#125; wakeUp() &#123; return `$&#123;this.name&#125; is waking up!`; &#125; // ...&#125;// Traditional styleAnimal.prototype.eat = function() &#123; return `$&#123;this.name&#125; is eating!`;&#125;Animal.prototype.sleep = function() &#123; return `$&#123;this.name&#125; is going to sleep!`;&#125; æ–¹æ³•å£°æ˜å¯¹æ¯” ä»ç¬¬ 4 è¡Œåˆ°ç¬¬ 14 è¡Œæ˜¯ ES6 é£æ ¼çš„ç±»ä¸­çš„æ–¹æ³•ã€‚ä¸è¿‡åœ¨ä¼ ç»Ÿçš„ JavaScript æ˜¯ä¸å¯èƒ½è¿™æ ·å†™çš„ï¼Œå› ä¸ºæ ¹æœ¬å°±ä¸å­˜åœ¨ class è¿™ä¸ªä¸œè¥¿æ¥è®©ä½ è½»æ¾çš„å£°æ˜æ–¹æ³•ã€‚åœ¨ä¼ ç»Ÿçš„ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æŠŠæ–¹æ³•æ·»åŠ åˆ° prototype ä¸Šæ¥è¾¾åˆ°ä¸ºç±»æ·»åŠ æ–¹æ³•è¿™ä¸€ç›®çš„ã€‚ç¬¬ 19 è¡Œåˆ°ç¬¬ 29 è¡Œæ˜¯ä¸ºä¼ ç»Ÿ JavaScript ç±»æ·»åŠ æ–¹æ³•çš„å†™æ³•ã€‚ extends åœ¨ä¼ ç»Ÿ JavaScript ä¸­çš„å¯¹åº”å½“æˆ‘ä»¬è¦ä»çˆ¶ç±»æ‰©å±•ä¸€ä¸ªå­ç±»æ—¶ï¼Œä¸¤ç§å†™æ³•çš„å·®å¼‚å°±æ›´å¤§äº†ã€‚å‚è§ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š 123456789101112131415// ES6 styleclass Gorilla extends Animal &#123; constructor(name, weight) &#123; super(name, weight); &#125; //...&#125;// Traditional stylefunction Gorilla(name, weight) &#123; Animal.call(this, name, weight);&#125;Gorilla.prototype = Object.create(Animal.prototype);Gorilla.prototype.constructor = Gorilla; extends å…³é”®å­—ä¸ä¼ ç»Ÿå®ç°æ–¹å¼çš„å¯¹æ¯” æˆ‘ä»¬çœ‹åˆ° extends å…³é”®å­—ç”¨ ES6 çš„é£æ ¼å¤„ç†äº†ä»çˆ¶ç±» Animal æ‰©å±•å‡ºå­ç±»çš„æ“ä½œï¼Œä¸è¿‡è¿™é‡Œä¹Ÿç”¨åˆ°äº† super å…³é”®å­—æ¥ç¡®ä¿ Gorilla çš„æ„é€ å‡½æ•°è°ƒç”¨äº† Animal ç±»ï¼Œè¿™æ ·å®ƒå°±èƒ½ç»§æ‰¿ Animal çš„ç‰¹æ€§å’Œè¡Œä¸ºã€‚åœ¨è¿™é‡Œï¼Œsuper å…³é”®å­—æ˜¯ä½œä¸ºå‡½æ•°æ¥è°ƒç”¨ Animal ç±»æ¥åˆå§‹åŒ– Gorillaã€‚è¿™æ—¶å€™ï¼Œsuper çš„ä½œç”¨ç›¸å½“äº Animal.call(this,â€¦)ã€‚ è‹¥æ˜¯ç”¨ä¼ ç»Ÿçš„å†™æ³•æ¥å®ç°ç»§æ‰¿ï¼Œåˆ™è¦å¤šå‡ ä¸ªæ­¥éª¤ã€‚é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªå­ç±» Gorilla çš„å‡½æ•°ï¼Œå¦‚ä»£ç ç¬¬ 10 è¡Œæ‰€ç¤ºã€‚ç”±äº Gorilla è¦ç»§æ‰¿ Animal çš„ç‰¹æ€§å’Œè¡Œä¸ºï¼Œå®ƒéœ€è¦åœ¨ Gorilla çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨ Animal çš„æ„é€ å‡½æ•°ï¼Œå¦‚ä»£ç ç¬¬ 11 è¡Œæ‰€ç¤ºï¼Œè¿™è¡Œä¸ç¬¬ 4 è¡Œçš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡æˆ‘ä»¬éœ€è¦æ˜¾å¼çš„ä¼ é€’ â€œthisâ€ å¼•ç”¨ç»™ Animal ç±»ä»¥ä¿è¯è°ƒç”¨æ˜¯åœ¨ Gorilla ä¸­å‘ç”Ÿçš„ã€‚ ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°† Gorilla å‡½æ•°çš„ prototype è®¾ç½®ä¸ºä¸€ä¸ªä» Animal çš„ prototype åˆ›å»ºçš„æ–°å¯¹è±¡ï¼Œå¦‚ä»£ç ç¬¬ 11 è¡Œæ‰€ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±é‡å†™äº† Gorilla çš„ prototype å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ç¬¬ 15 è¡Œä¸­æ˜¾å¼çš„è®¾ç½® Gorilla çš„æ„é€ å‡½æ•°ã€‚é€šè¿‡è¿™äº›æ­¥éª¤æˆ‘ä»¬å°† Gorilla ç±»è®¾ç½®æˆä¸º Animal ç±»çš„å­ç±»ã€‚ super åœ¨ä¼ ç»Ÿ JavaScript ä¸­çš„å¯¹åº”æˆ‘ä»¬å·²ç»è§è¯†è¿‡ super å…³é”®å­—çš„ä¸€ç§å¯¹åº”ï¼Œå³ï¼Œä¸‹é¢ä»£ç ç‰‡æ®µç¬¬ 4 è¡Œå’Œç¬¬ 19 è¡Œï¼Œsuper è¢«ç”¨ä½œå‡½æ•°ã€‚ 1234567891011121314151617181920212223242526272829// ES6 styleclass Gorilla extends Animal &#123; constructor(name, weight) &#123; super(name, weight); &#125; showVigour() &#123; return `$&#123;super.eat()&#125; $&#123;this.poundChest()&#125;`; &#125; dailyRoutine() &#123; return `$&#123;super.wakeUp()&#125; $&#123;this.poundChest()&#125; $&#123;super.eat()&#125; $&#123;super.sleep()&#125;`; &#125; // ...&#125;// Traditional stylefunction Gorilla(name, weight) &#123; Animal.call(this, name, weight);&#125;Gorilla.prototype = Object.create(Animal.prototype);Gorilla.prototype.constructor = Gorilla;Gorilla.prototype.showVigour = function () &#123; return `$&#123;Animal.prototype.eat.call(this)&#125; $&#123;this.poundChest()&#125;`;&#125;Gorilla.prototype.dailyRoutine = function() &#123; super å…³é”®å­—ä¸ä¼ ç»Ÿå®ç°æ–¹å¼çš„å¯¹æ¯” super å…³é”®å­—ä¹Ÿå¯ä»¥ç”¨ä½œçˆ¶ç±»çš„å®ä¾‹ï¼Œå¦‚ä»£ç ç¬¬ 8 è¡Œå’Œç¬¬ 12 è¡Œè¿™æ ·è°ƒç”¨ Animal ç±»çš„æ–¹æ³•ã€‚ ä»£ç ç¬¬ 26 è¡Œå±•ç¤ºäº†åœ¨ä¼ ç»Ÿçš„ JavaScript ä¸­å®ç°åŒæ ·çš„ç›®çš„ï¼Œsuper å®ä¾‹ç›¸å½“äºä¼ ç»Ÿå†™æ³•çš„ ParentClassName.prototype.methodName.call(this, â€¦)ã€‚å³ä¼ ç»Ÿå†™æ³•éœ€è¦ç¼–å†™å¤§é‡çš„ä»£ç æ¥ç¡®ä¿çˆ¶ç±»çš„æ–¹æ³•è¢«è°ƒç”¨ã€‚ ç»“è®ºæˆ‘å¾ˆç¡®å®šï¼Œä½ ä»¬åœ¨äº†è§£äº†ä¼ ç»Ÿçš„å†™æ³•æ˜¯å¤šä¹ˆçš„å¤æ‚ä¹‹åä¸€å®šä¼šæ¯«ä¸çŠ¹è±«çš„é€‰æ‹© ES6 çš„ç±»å’Œç»§æ‰¿ç‰¹æ€§ã€‚è€Œä¸”ï¼ŒChrome å’Œ Firefox å·²ç»æ”¯æŒäº† ES6ï¼Œä¸è¿‡ä¸ºäº†ç¡®ä¿ ES6 ç‰¹æ€§åœ¨æ‰€æœ‰çš„æµè§ˆå™¨ä¸­éƒ½èƒ½æ‰§è¡Œï¼Œä½ è¿˜æ˜¯éœ€è¦ä¸€ä¸ª babel è½¬è¯‘å™¨æ¥æŠŠ ES6 ä»£ç è½¬æ¢æˆ ES5 ä»£ç ã€‚ ç¥ç¼–ç å¿«ä¹ï¼ğŸ˜„","link":"/2019/05/27/super-extends-js/"},{"title":"ã€Œè¯‘ã€åŠ¨æ‰‹å®ç°ä¸€ä¸ªå•æ–‡ä»¶ Web Components","text":"ä½œè€…ï¼šTomasz JakutåŸæ–‡é“¾æ¥ï¼šImplementing single file Web Components å¯èƒ½æ¯ä¸ªäº†è§£ Vue æ¡†æ¶çš„äººéƒ½å¬è¯´è¿‡å®ƒçš„â€œå•æ–‡ä»¶ç»„ä»¶ï¼ˆsingle file componentsï¼‰â€ã€‚è¿™ä¸ªè¶…ç®€å•çš„æ¦‚å¿µè®© Web å¼€å‘äººå‘˜å¯ä»¥åªç”¨ä¸€ä¸ªæ–‡ä»¶æ¥å®šä¸€ä¸ªç»„ä»¶ã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆéå¸¸å¥½ç”¨ä»¥è‡³äºä¸€ä¸ªåœ¨æµè§ˆå™¨ä¸­åŒ…å«è¿™ç§æœºåˆ¶çš„ææ¡ˆå·²ç»å‡ºç°ã€‚ ä¸è¿‡å¾ˆä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªææ¡ˆè²Œä¼¼å·²ç»æ­»æ‰äº†ï¼Œä» 2017 å¹´ 8 æœˆä»¥åå°±å†æ²¡æœ‰ä»»ä½•è¿›å±•ã€‚å³ä½¿å¦‚æ­¤ï¼Œåœ¨ç°æœ‰å¯è¡ŒæŠ€æœ¯ä¸‹ç ”ç©¶è¿™ä¸ªè¯é¢˜å¹¶ä¸”åˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„å•æ–‡ä»¶ç»„ä»¶ä»ç„¶å€¼å¾—å†™ä¸€ç¯‡æ–‡ç« ï¼ å•æ–‡ä»¶ç»„ä»¶äº†è§£æ¸è¿›å¢å¼ºè¿™ä¸ªæœ¯è¯­çš„ Web å¼€å‘äººå‘˜åº”è¯¥ä¹Ÿå¬è¯´è¿‡â€œåˆ†å±‚â€è¿™ä¸ªè¯å„¿ã€‚åœ¨ç»„ä»¶ä¸­ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚å®é™…ä¸Šå±‚æ•°è¿˜ä¸å°‘å‘¢ï¼Œæ¯ä¸ªç»„ä»¶è‡³å°‘æœ‰ 3 å±‚ï¼šå†…å®¹/æ¨¡ç‰ˆï¼Œæ ·å¼å’Œè¡Œä¸ºã€‚æŒ‰ç…§ä¼ ç»Ÿçš„åšæ³•ï¼Œæ¯ä¸ªç»„ä»¶è‡³å°‘ä¼šè¢«åˆ†æˆ 3 ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ä¸€ä¸ª Button ç»„ä»¶å¯èƒ½ä¼šæ˜¯è¿™ä¸ªæ ·å­ï¼š 1234567Button/|| -- Button.html|| -- Button.css|| -- Button.js è¿™æ˜¯æŒ‰ç…§æŠ€æœ¯æ¥åˆ†å±‚ï¼ˆå†…å®¹/æ¨¡ç‰ˆï¼šHTMLï¼Œæ ·å¼ï¼šCSSï¼Œè¡Œä¸ºï¼šJSï¼‰ã€‚è¿™å°±æ˜¯è¯´--å¦‚æœä½ æ²¡æœ‰ç”¨æ„å»ºå·¥å…·çš„è¯--æµè§ˆå™¨å°†éœ€è¦åŠ è½½ 3 ä¸ªæ–‡ä»¶ã€‚äºæ˜¯æœ‰äººä¾¿æå‡ºä¸€ä¸ªæ¦‚å¿µï¼Œä¿ç•™åˆ†å±‚çš„æ¦‚å¿µï¼Œä½†ä¸æ˜¯æŒ‰ç…§æŠ€æœ¯ç§ç±»åˆ†æˆä¸åŒä½†æ–‡ä»¶ã€‚äºæ˜¯å•æ–‡ä»¶ç»„ä»¶è¯ç”Ÿäº†ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘å¯¹â€œæŒ‰æŠ€æœ¯åˆ†å±‚â€è¿™ä¸ªåšæ³•æŒæ€€ç–‘æ€åº¦ã€‚è€Œä¸”ï¼Œè¿™ä¸ªæ¦‚å¿µå®é™…ä¸Šç»å¸¸åœ¨ä¸€äº›å…³äºæ”¾å¼ƒåˆ†å±‚çš„äº‰è®ºä¸­è¢«æåˆ°--æ ¹æœ¬å°±æ˜¯å®Œå…¨å¯¹ç«‹çš„ä¸¤ä»¶äº‹ã€‚ å•æ–‡ä»¶çš„ Button ç»„ä»¶çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š 1234567891011&lt;template&gt; &lt;!-- Button.html contents go here. --&gt;&lt;/template&gt;&lt;style&gt; /* Button.css contents go here. */&lt;/style&gt;&lt;script&gt; // Button.js contents go here.&lt;/script&gt; å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œå•æ–‡ä»¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæœ‰å†…éƒ¨æ ·å¼è¡¨ã€script å’Œ &lt;template&gt; æ ‡ç­¾çš„æ ‡å‡† HTMLã€‚å¾—ç›Šäºè¿™ç§ç®€æ´çš„å®ç°ï¼Œä½ çš„ç»„ä»¶ä¸éœ€è¦åˆ†æˆå¤šä¸ªæ–‡ä»¶ä¹Ÿæœ‰å¾ˆæ˜æ˜¾çš„åˆ†å±‚ï¼ˆå†…å®¹/æ¨¡ç‰ˆï¼š&lt;template&gt;ï¼Œæ ·å¼ï¼š&lt;style&gt;ï¼Œè¡Œä¸ºï¼š&lt;script&gt; ï¼‰ã€‚ ä¸è¿‡ä»ç„¶åˆä¸€ä¸ªæœ€é‡è¦çš„é—®é¢˜è¦è§£å†³ï¼šå¦‚ä½•ä½¿ç”¨å®ƒå‘¢ï¼Ÿ åŸºç¡€æ¦‚å¿µæˆ‘ä»¬å…ˆæ¥ç¼–å†™ä¸€ä¸ªå«åš loadComponent() çš„ å…¨å±€å‡½æ•°æ¥åŠ è½½æˆ‘ä»¬çš„ç»„ä»¶ã€‚ 12345window.loadComponent = ( function() &#123; function loadComponent( URL ) &#123;&#125; return loadComponent;&#125;() ); æˆ‘ç”¨åˆ°äº†è¿™äº›ç»„ä»¶æ¨¡å¼ã€‚ä½ å¯ä»¥å®šä¹‰æ‰€æœ‰éœ€è¦çš„è¾…åŠ©å‡½æ•°ï¼ŒåªæŠŠ loadComponent æš´éœ²ç»™å¤–éƒ¨ä½œç”¨åŸŸã€‚ç›®å‰è¿™ä¸ªå‡½æ•°æ²¡æœ‰ä»»ä½•åŠŸèƒ½ã€‚ ç„¶è€Œæˆ‘ä»¬ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿éœ€è¦åŠ è½½ï¼Œæ‰€ä»¥è¿™ä¹Ÿä¸æ˜¯ä»€ä¹ˆé—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬å‡è®¾ä½ è¦åˆ›å»ºä¸€ä¸ª &lt;hello-world&gt; ç»„ä»¶ç”¨äºæ˜¾ç¤ºä»¥ä¸‹æ–‡å­—ï¼š Hello, world! My name is &lt;æŒ‡å®šçš„åç§°&gt;. è€Œä¸”å½“ä½ ç‚¹å‡»äº†è¿™ä¸ªç»„ä»¶ï¼Œå®ƒä¼šå¼¹å‡ºä¸€ä¸ªæ¶ˆæ¯ï¼š Donâ€™t touch me! æŠŠç»„ä»¶ä»£ç ä¿å­˜ä¸º HelloWorld.wcï¼ˆ.wc ä»£è¡¨ Web Componentï¼‰ã€‚ç°é˜¶æ®µå®ƒæ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516171819&lt;template&gt; &lt;div class=\"hello\"&gt; &lt;p&gt;Hello, world! My name is &lt;slot&gt;&lt;/slot&gt;.&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;style&gt; div &#123; background: red; border-radius: 30px; padding: 20px; font-size: 20px; text-align: center; width: 300px; margin: 0 auto; &#125;&lt;/style&gt;&lt;script&gt;&lt;/script&gt; ç°åœ¨ä½ è¿˜æ²¡æœ‰ä¸ºå®ƒæ·»åŠ ä»»ä½•åŠŸèƒ½ã€‚åªæ˜¯å®šä¹‰äº†å®ƒçš„æ¨¡ç‰ˆå’Œæ ·å¼ã€‚ä½¿ç”¨æ²¡æœ‰ä»»ä½•é€‰æ‹©å™¨çš„ div ä»¥åŠ &lt;slot&gt; å…ƒç´ çš„å‡ºç°æ„å‘³ç€è¿™ä¸ªç»„ä»¶å°†ä½¿ç”¨ Shadow DOMã€‚ç¡®å®å¦‚æ­¤ï¼šæ‰€æœ‰çš„æ ·å¼å’Œæ¨¡ç‰ˆé»˜è®¤éƒ½ä¼šè¢«éšè—åœ¨æš—å¤„ã€‚ ç»„ä»¶åœ¨ç½‘ç«™ä¸Šçš„ä½¿ç”¨æ–¹å¼åº”è¯¥å°½å¯èƒ½çš„ç®€å•ï¼š 123456&lt;hello-world&gt;Comandeer&lt;/hello-world&gt;&lt;script src=\"loader.js\"&gt;&lt;/script&gt;&lt;script&gt; loadComponent( 'HelloWorld.wc' );&lt;/script&gt; ç»„ä»¶çš„ç”¨æ³•è·Ÿæ ‡å‡†çš„ Custom Element ä¸€æ ·ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯åœ¨ä½¿ç”¨ loadComponent() æ–¹æ³•ä¹‹å‰éœ€è¦å…ˆåŠ è½½ä¸€ä¸ª jsï¼ˆè¿™ä¸ªæ–¹æ³•ä½äº loader.js æ–‡ä»¶ä¸­ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•è´Ÿè´£æ‰€æœ‰çš„ç¹é‡å·¥ä½œï¼Œåƒè·å–ç»„ä»¶å’Œåœ¨ customElements.define() ä¸­æ³¨å†Œç»„ä»¶ã€‚ ä»¥ä¸Šå°±æ˜¯æ‰€æœ‰çš„åŸºç¡€æ¦‚å¿µï¼Œæ¥ä¸‹æ¥è¦å¼€å§‹åŠ¨çœŸæ ¼çš„äº†ï¼ åŸºç¡€ loaderå¦‚æœä½ æƒ³ä»å¤–éƒ¨æ–‡ä»¶ä¸­åŠ è½½æ•°æ®ï¼Œä½ å¿…é¡»ä½¿ç”¨ç¥åœ£çš„ Ajaxã€‚ç„¶è€Œå¦‚ä»Šå·²ç»æ˜¯ 2018 å¹´äº†ï¼Œç°åœ¨ä½ å¯ä»¥ä»¥ Fetch API çš„å½¢å¼ä½¿ç”¨ Ajaxï¼š 123function loadComponent( URL ) &#123; return fetch( URL );&#125; æ¼‚äº®ï¼ä¸è¿‡ç°åœ¨ä½ åªæ˜¯è·å–äº†æ–‡ä»¶ï¼Œæ²¡æœ‰å¯¹å®ƒåšä»»ä½•æ“ä½œã€‚è·å–å®ƒçš„å†…å®¹çš„æœ€å¥½æ–¹å¼å°±æ˜¯æŠŠå®ƒè½¬æˆæ–‡å­—ï¼š 12345function loadComponent( URL ) &#123; return fetch( URL ).then( ( response ) =&gt; &#123; return response.text(); &#125; );&#125; ç”±äºç°åœ¨ loadComponent() è¿”å›çš„ fetch() å‡½æ•°çš„ç»“æœæ˜¯ä¸€ä¸ª Promiseã€‚ä½ å¯ä»¥æ®æ­¤æ£€æŸ¥å†…å®¹æ˜¯å¦çœŸæ­£åŠ è½½å¹¶æ£€æŸ¥å®ƒæ˜¯ä¸æ˜¯è¢«è½¬æˆäº†æ–‡å­—ï¼š 123loadComponent( 'HelloWorld.wc' ).then( ( component ) =&gt; &#123; console.log( component );&#125; ); Chrome console æ˜¾ç¤º HelloWorld.wc å·²ç»åŠ è½½å®Œæˆå¹¶è½¬æˆäº†çº¯æ–‡æœ¬ è¿è¡ŒæˆåŠŸï¼ è§£æè¿”å›å€¼ä¸è¿‡ï¼Œåªæ˜¯çº¯æ–‡æœ¬å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ä½ ç”¨ HTML å†™è¿™ä¸ªç»„ä»¶ä¸æ˜¯ä¸ºäº†åšé‚£äº›ä¸å…è®¸åšçš„äº‹æƒ…ã€‚æ¯•ç«Ÿä½ æ˜¯åœ¨æµè§ˆå™¨é‡Œ--ä¸€ä¸ªåˆ›å»º DOM çš„ç¯å¢ƒã€‚åˆ©ç”¨å®ƒçš„åŠ›é‡ï¼ æµè§ˆå™¨ä¸­åˆä¸€ä¸ªå¾ˆæ£’çš„ DOMPaser ç±»è®©ä½ å¯ä»¥åˆ›å»º DOM è§£æå™¨ã€‚æˆ‘ä»¬æŠŠå®ƒå®ä¾‹åŒ–ç”¨æ¥æŠŠç»„ä»¶è½¬æ¢æˆ DOMï¼š 1234567return fetch( URL ).then( ( response ) =&gt; &#123; return response.text();&#125; ).then( ( html ) =&gt; &#123; const parser = new DOMParser(); // 1 return parser.parseFromString( html, 'text/html' ); // 2&#125; ); é¦–å…ˆåˆ›å»ºä¸€ä¸ªè§£æå™¨å®ä¾‹(1)ï¼Œç„¶åè§£æç»„ä»¶çš„æ–‡æœ¬å†…å®¹(2)ã€‚å€¼å¾—æ³¨æ„ä½ ä½¿ç”¨çš„æ˜¯ HTML æ¨¡å¼ï¼ˆ&#39;text/html&#39;ï¼‰ã€‚å¦‚æœå¸Œæœ›ä»£ç æ›´å¥½çš„éµå¾ª JSX è§„èŒƒæˆ–åŸç”Ÿ Vue ç»„ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ XML æ¨¡å¼ï¼ˆ&#39;text/xml&#39;ï¼‰ã€‚ä¸è¿‡è¿™æ ·ä¸€æ¥ä½ å°±è¦æ›´æ”¹ç»„ä»¶çš„ç»“æ„äº†ï¼ˆä¾‹å¦‚ï¼šå¢åŠ ä¸€ä¸ªåŒ…å«æ‰€æœ‰å†…å®¹çš„ä¸»å…ƒç´ ï¼‰ã€‚ ç°åœ¨å¦‚æœä½ å†æŸ¥çœ‹ loadComponent() çš„è¿”å›å€¼ï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªå®Œæ•´çš„ DOM æ ‘ã€‚ Chrome console æ˜¾ç¤º HelloWorld.wc çš„å†…å®¹å·²ç»è¢«è½¬æˆäº† DOM æˆ‘è¯´çš„â€œå®Œæ•´çš„â€çœŸçš„æ˜¯éå¸¸å®Œæ•´ã€‚ä½ å¾—åˆ°äº†ä¸€ä¸ªå¸¦æœ‰ &lt;head&gt; å’Œ &lt;body&gt; å…ƒç´ çš„å®Œæ•´çš„ HTML æ–‡æ¡£ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œç»„ä»¶çš„å†…å®¹å®Œå…¨åœ¨ &lt;head&gt; å…ƒç´ ä¸­ã€‚è¿™æ˜¯ HTML è§£æå™¨çš„å·¥ä½œæ–¹å¼å¯¼è‡´çš„ã€‚å»ºç«‹ DOM æ ‘çš„åŸç†åœ¨ HTML LS è§„èŒƒä¸­æœ‰è¯¦ç»†çš„æè¿°ã€‚å¤ªé•¿äº†å°±ä¸è¯¦ç»†è¯´äº†ï¼Œä½ å¯ä»¥ç®€å•çš„è®¤ä¸ºè§£æå™¨ä¼šæŠŠæ‰€æœ‰å…ƒç´ éƒ½æ”¾åœ¨ &lt;head&gt; å…ƒç´ ä¸­ï¼Œç›´åˆ°å®ƒé‡åˆ°äº†åªèƒ½æ”¾åœ¨ &lt;body&gt; ä¸­çš„å…ƒç´ ã€‚ä½ ç”¨åˆ°çš„æ‰€æœ‰å…ƒç´ ï¼ˆ&lt;template&gt;ï¼Œ&lt;style&gt;ï¼Œ&lt;script&gt;ï¼‰éƒ½å…è®¸æ”¾åœ¨ &lt;head&gt; ä¸­ã€‚å‡å¦‚ä½ åœ¨ç»„ä»¶çš„å¼€å¤´æ·»åŠ äº†ä¸€ä¸ªç©ºçš„ &lt;p&gt; æ ‡ç­¾ï¼Œé‚£ä¹ˆå…¨éƒ¨å†…å®¹éƒ½ä¼šè¢«æ¸²æŸ“åœ¨ &lt;body&gt; ä¸­ã€‚ å¦ç‡çš„è¯´ï¼Œè¿™ä¸ªç»„ä»¶æ˜¯è¢«å½“ä½œæœ‰ç¼ºé™·çš„ HTML æ–‡æ¡£æ¥å¤„ç†çš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä»¥ DOCTYPE å£°æ˜å¼€å¤´ã€‚å› æ­¤å®ƒæ˜¯åœ¨ä¸€ä¸ªè¢«ç§°ä¸º quirks mode çš„æ¨¡å¼ä¸‹æ¸²æŸ“çš„ã€‚å¥½åœ¨è¿™å¯¹ä½ æ²¡ä»€ä¹ˆå½±å“ï¼Œå› ä¸ºä½ åªæ˜¯ç”¨ DOM è§£æå™¨å‰ªåˆ‡å‡ºæ‰€éœ€çš„ç»„ä»¶å†…å®¹ã€‚ æœ‰äº† DOM æ ‘ï¼Œä½ èƒ½è·å–ä½ æ‰€éœ€çš„é‚£éƒ¨åˆ†å…ƒç´ ï¼š 12345678910111213141516return fetch( URL ).then( ( response ) =&gt; &#123; return response.text();&#125; ).then( ( html ) =&gt; &#123; const parser = new DOMParser(); const document = parser.parseFromString( html, 'text/html' ); const head = document.head; const template = head.querySelector( 'template' ); const style = head.querySelector( 'style' ); const script = head.querySelector( 'script' ); return &#123; template, style, script &#125;;&#125; ); æŠŠæ‰€æœ‰çš„è·å–å’Œè§£æä»£ç ç§»åˆ°ç¬¬ä¸€ä¸ªè¾…åŠ©å‡½æ•° fetchAndParse() ä¸­ï¼š 1234567891011121314151617181920212223242526window.loadComponent = ( function() &#123; function fetchAndParse( URL ) &#123; return fetch( URL ).then( ( response ) =&gt; &#123; return response.text(); &#125; ).then( ( html ) =&gt; &#123; const parser = new DOMParser(); const document = parser.parseFromString( html, 'text/html' ); const head = document.head; const template = head.querySelector( 'template' ); const style = head.querySelector( 'style' ); const script = head.querySelector( 'script' ); return &#123; template, style, script &#125;; &#125; ); &#125; function loadComponent( URL ) &#123; return fetchAndParse( URL ); &#125; return loadComponent;&#125;() ); Fetch API å¹¶ä¸æ˜¯ä»å¤–éƒ¨æ–‡ä»¶ä¸­è·å– DOM æ ‘çš„å”¯ä¸€æ–¹æ³•ã€‚XMLHttpRequest æœ‰ä¸€ä¸ªä¸“é—¨çš„æ–‡ä»¶æ¨¡å¼ è®©ä½ å¯ä»¥çœæ‰æ•´ä¸ªçš„è§£ææ­¥éª¤ã€‚ä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼šXMLHttpRequest æ²¡æœ‰ Promise å‹çš„ APIï¼Œè¿™éœ€è¦ä½ è‡ªè¡Œå®ç°ã€‚ æ³¨å†Œç»„ä»¶æ—¢ç„¶å·²ç»æ‹¿åˆ°æ‰€æœ‰éœ€è¦çš„éƒ¨ä»¶äº†ï¼Œç°åœ¨æ¥ç¼–å†™ç”¨äºæ³¨å†Œè‡ªå®šä¹‰ç»„ä»¶çš„ registerComponent() å‡½æ•°ï¼š 123456789101112131415window.loadComponent = ( function() &#123; function fetchAndParse( URL ) &#123; [â€¦] &#125; function registerComponent() &#123; &#125; function loadComponent( URL ) &#123; return fetchAndParse( URL ).then( registerComponent ); &#125; return loadComponent;&#125;() ); æé†’ä¸€ä¸‹ï¼šè‡ªå®šä¹‰å…ƒç´ å¿…é¡»æ˜¯ç»§æ‰¿è‡ª HTMLElement çš„ç±»ã€‚å¦å¤–æ‰€æœ‰çš„ç»„ä»¶éƒ½ä¼šç”¨ Shadow DOM æ¥æ‰¿è½½æ ·å¼å’Œæ¨¡ç‰ˆå†…å®¹ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„ç»„ä»¶å°†ä½¿ç”¨ç›¸åŒçš„ classã€‚åˆ›å»ºï¼š 1234567891011121314function registerComponent( &#123; template, style, script &#125; ) &#123; class UnityComponent extends HTMLElement &#123; connectedCallback() &#123; this._upcast(); &#125; _upcast() &#123; const shadow = this.attachShadow( &#123; mode: 'open' &#125; ); shadow.appendChild( style.cloneNode( true ) ); shadow.appendChild( document.importNode( template.content, true ) ); &#125; &#125;&#125; ä½ å¯ä»¥æŠŠå®ƒå®šä¹‰åœ¨ registerComponent() å†…éƒ¨ï¼Œå› ä¸ºè¿™ä¸ª class ä¼šç”¨åˆ°ä¼ ç»™è¿™ä¸ªå‡½æ•°çš„ä¸€äº›æ•°æ®ã€‚è¿™ä¸ª class ä¼šç”¨ä¸€ä¸ªè·Ÿè¿™ç¯‡å…³äºå£°æ˜å¼ DOM çš„æ–‡ç« ï¼ˆæ³¢å…°è¯­ï¼‰ æ‰€ä»‹ç»çš„ç¨å¾®æœ‰æ‰€ä¸åŒçš„æœºåˆ¶æ¥é™„åŠ  Shadow DOMã€‚ ä¸æ³¨å†Œç»„ä»¶ç›¸å…³çš„åªå‰©ä¸‹ä¸€ä»¶äº‹--ç»™ä»–å‘½åå¹¶æ·»åŠ åˆ°é¡µé¢ä¸Šçš„ç»„ä»¶ä¸­ã€‚ 1234567function registerComponent( &#123; template, style, script &#125; ) &#123; class UnityComponent extends HTMLElement &#123; [â€¦] &#125; return customElements.define( 'hello-world', UnityComponent );&#125; ç°åœ¨æµ‹è¯•è¿™ä¸ªç»„ä»¶ï¼Œå®ƒçœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š Chrome ä¸­æ˜¾ç¤ºçš„ç»„ä»¶ï¼šçº¢è‰²åœ†è§’æ–¹å—ï¼Œå†…éƒ¨æœ‰ â€œHello, world! My name is Comandeerâ€å­—æ · è·å–è„šæœ¬å†…å®¹ç®€å•çš„éƒ¨åˆ†å·²ç»åšå®Œäº†ã€‚ç°åœ¨è¯¥åšç‚¹é«˜éš¾åº¦çš„ï¼šæ·»åŠ è¡Œä¸ºå±‚å¹¶ä¸”â€¦â€¦å°†ç»„ä»¶åç§°åŠ¨æ€åŒ–ã€‚ä¸Šä¸€æ­¥é‡Œä½ æŠŠç»„ä»¶åç§°ç¡¬ç¼–ç åœ¨ä»£ç é‡Œäº†ï¼Œä¸è¿‡ï¼Œå®ƒåº”è¯¥æ˜¯ä»ç»„ä»¶ä¸Šè·å–ã€‚åŒæ ·çš„åšæ³•ä¹Ÿä¼šè¢«ç”¨åœ¨ä¸ºè‡ªå®šä¹‰ç»„ä»¶ç»‘å®šäº‹ä»¶ç›‘å¬å™¨ä¸Šã€‚ä½¿ç”¨åŸºäº Vue çš„çº¦å®šï¼š 12345678910111213141516&lt;template&gt; [â€¦]&lt;/template&gt;&lt;style&gt; [â€¦]&lt;/style&gt;&lt;script&gt; export default &#123; // 1 name: 'hello-world', // 2 onClick() &#123; // 3 alert( `Don't touch me!` ); &#125; &#125;&lt;/script&gt; å‡å®šç»„ä»¶ä¸­çš„ &lt;script&gt; æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒå¯ä»¥å¯¼å‡ºå†…å®¹(1)ï¼Œå¯¼å‡ºçš„æ˜¯ä¸€ä¸ªåŒ…å«ç»„ä»¶åç§°(2)å’Œä»¥ on... å¼€å¤´çš„äº‹ä»¶ç›‘å¬å™¨æ–¹æ³•(3)çš„å¯¹è±¡ã€‚ çœ‹èµ·æ¥ä¸é”™ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ³„æ¼ï¼ˆå› ä¸ºåœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä¸å­˜åœ¨æ¨¡å—ï¼‰ã€‚ç„¶è€Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å¤„ç†å†…éƒ¨æ¨¡å—çš„å¯¼å‡ºå¹¶æ²¡æœ‰ä¸€ä¸ªæ ‡å‡†ï¼ˆé‚£äº›ç›´æ¥å†™åœ¨ HTML æ–‡æ¡£ä¸­çš„ä»£ç ä¹Ÿæ˜¯ï¼‰ã€‚å¯¼å…¥å£°æ˜ä¼šå‡è®¾å®ƒå¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ¨¡å—æ ‡è¯†ç¬¦ã€‚å¤šæ•°æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªä»£ç æ–‡ä»¶çš„ URLã€‚å†…éƒ¨æ¨¡æ²¡æœ‰è¿™ç§æ ‡è¯†ç¬¦ã€‚ åˆ«ç€æ€¥æ”¾å¼ƒï¼Œä½ å¯ä»¥ç”¨ä¸€ä¸ªè¶…çº§è„çš„ hackã€‚è‡³å°‘æœ‰ä¸¤ç§æ–¹æ³•èƒ½å¼ºåˆ¶æµè§ˆå™¨å°†æ–‡æœ¬å½“ä½œæ–‡ä»¶æ¥å¤„ç†ï¼šData URI å’Œ Object URIã€‚ Stack Overflow å»ºè®®ä½¿ç”¨ Service Workerã€‚ä¸è¿‡åœ¨æˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹ä¸­æœ‰ç‚¹å¤§æå°ç”¨äº†ã€‚ Data URI å’Œ Object URIData URI æ˜¯ä¸€ä¸ªå¤è€è€ŒåŸå§‹çš„æ–¹æ¡ˆã€‚å®ƒæ˜¯å»ç”¨é™¤æ–‡ä»¶å†…å®¹ä¸­æ— ç”¨çš„ç©ºæ ¼å¹¶ä¸”å¦‚æœæŒ‡å®šä¼šæŠŠæ‰€æœ‰å†…å®¹è½¬æˆ Base64 ç¼–ç çš„æ–¹å¼å°†æ–‡ä»¶è½¬æˆ URLã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ JavaScript æ–‡ä»¶ï¼š 1export default true; å®ƒçš„ Data URI å½¢å¼æ˜¯è¿™æ ·çš„ï¼š 1data:application/javascript;base64,ZXhwb3J0IGRlZmF1bHQgdHJ1ZTs= ä½ å¯ä»¥åƒå¼•ç”¨ä¸€ä¸ªæ–‡ä»¶ä¸€æ ·å¼•ç”¨è¿™ä¸ª URLï¼š 123import test from 'data:application/javascript;base64,ZXhwb3J0IGRlZmF1bHQgdHJ1ZTs=';console.log( test ); ç„¶è€Œæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡º Data URI æ–¹å¼çš„ç¼ºé™·ï¼šJavaScript æ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼ŒURL ä¹Ÿå°±å˜å¾—è¶Šæ¥è¶Šé•¿ã€‚ä»¥ç®€æ˜çš„æ–¹å¼å°†äºŒè¿›åˆ¶æ•°æ®è½¬æˆ Data URI ä¹Ÿå¾ˆå›°éš¾ã€‚å› æ­¤äººä»¬åˆ›é€ äº† Object URIã€‚å®ƒæ˜¯å‡ ä¸ªæ ‡å‡†çš„äº§ç‰©ï¼ŒåŒ…æ‹¬ File API å’ŒåŒ…æ‹¬ &lt;video&gt; å’Œ &lt;audio&gt; çš„ HTML 5.xã€‚Object URI çš„ç›®æ ‡å¾ˆç®€å•ï¼šä»äºŒè¿›åˆ¶æ•°æ®ç”Ÿæˆè™šæ‹Ÿæ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ªåªåœ¨å½“å‰é¡µé¢æœ‰æ•ˆçš„å”¯ä¸€ URLã€‚ç®€å•çš„è¯´ï¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå…·æœ‰å”¯ä¸€åç§°çš„æ–‡ä»¶ã€‚è¿™æ ·ä½ å°±åˆ©ç”¨äº† Data URI çš„æ‰€æœ‰ä¼˜åŠ¿ï¼ˆç”¨ç®€å•çš„æ–¹å¼åˆ›å»ºæ–°â€œæ–‡ä»¶â€ï¼‰åˆé¿å…äº†å®ƒçš„ç¼ºé™·ï¼ˆä½ ä¸ç”¨åœ¨ä»£ç ä¸­åŒ…å«å¯èƒ½å¤šè¾¾ 100MB çš„æ–‡å­—äº†ï¼‰ã€‚ æµåª’ä½“ï¼ˆä¾‹å¦‚ï¼š&lt;video&gt; å’Œ &lt;audio&gt;ï¼‰æˆ–è€…ä½¿ç”¨æ‹–æ‹½æ–¹å¼é€šè¿‡ input[type=file] ä¸Šä¼ æ–‡ä»¶ç»å¸¸ä¼šåˆ›å»º Object URIã€‚ä¸è¿‡ä½ ä¹Ÿå¯ä»¥ç”¨ File å’Œ Blob ç±»æ‰‹åŠ¨åˆ›å»ºç±»ä¼¼çš„æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æˆ‘ä»¬è¦æŠŠæ¨¡å—çš„å†…å®¹å‚¨å­˜åœ¨ Blog ç±»ä¸­å¹¶æŠŠå®ƒè½¬æ¢æˆ Object URIï¼š 1234const myJSFile = new Blob( [ 'export default true;' ], &#123; type: 'application/javascript' &#125; );const myJSURL = URL.createObjectURL( myJSFile );console.log( myJSURL ); // blob:https://blog.comandeer.pl/8e8fbd73-5505-470d-a797-dfb06ca71333 åŠ¨æ€å¯¼å…¥ä¸è¿‡è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šimport å£°æ˜æ— æ³•æ¥æ”¶ä¸€ä¸ªä½œä¸ºæ¨¡å—æ ‡è¯†ç¬¦çš„å˜é‡ã€‚è¿™æ„å‘³ç€ä½ èƒ½æŠŠè¿™ä¸ªæ¨¡å—è½¬æ¢æˆâ€œæ–‡ä»¶â€å´æ— æ³•å¯¼å…¥ã€‚åˆ°å¤´æ¥è¿˜æ˜¯è¡Œä¸é€šï¼Ÿ ä¸æ˜¯çš„ã€‚å¾ˆæ—©ä»¥å‰äººä»¬å°±æ³¨æ„åˆ°äº†è¿™ä¸ªé—®é¢˜å¹¶æå‡ºäº†åŠ¨æ€å¯¼å…¥ææ¡ˆã€‚å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ˆ2018 å¹´ 8 æœˆï¼‰å·²ç»è¿›è¡Œåˆ°æ ‡å‡†åŒ–çš„ç¬¬ä¸‰é˜¶æ®µäº†ï¼Œåœ¨æµè§ˆå™¨å’Œå…¶ä»– JavaScript ç¯å¢ƒä¸­å·²ç»å¼€å§‹éƒ¨ç½²ã€‚ä½¿ç”¨å˜é‡ä½œä¸ºæ¨¡å—æ ‡è¯†ç¬¦ä»¥åŠåŠ¨æ€å¯¼å…¥å·²ç»æ²¡é—®é¢˜äº†ï¼š 123456const myJSFile = new Blob( [ 'export default true;' ], &#123; type: 'application/javascript' &#125; );const myJSURL = URL.createObjectURL( myJSFile );import( myJSURL ).then( ( module ) =&gt; &#123; console.log( module.default ); // true&#125; ); å¯ä»¥çœ‹åˆ°ï¼Œimport() çš„ç”¨æ³•è·Ÿå‡½æ•°ä¸€æ ·å¹¶è¿”å›ä¸€ä¸ª Promiseï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£è¡¨æ¨¡å—çš„å¯¹è±¡ã€‚åŒ…å«äº†æ‰€æœ‰å£°æ˜è¿‡çš„å¯¼å‡ºé¡¹ç›®ï¼Œé»˜è®¤çš„å¯¼å‡ºé¡¹ä»¥ default å±æ€§æ ‡è¯†ã€‚ éƒ¨ç½²æ—¢ç„¶ä½ å·²ç»çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œé‚£ä¹ˆå°±åŠ¨æ‰‹å§ã€‚æ·»åŠ ä¸‹ä¸€ä¸ªè¾…åŠ©å‡½æ•° getSettings()ã€‚å®ƒä¼šåœ¨ registerComponents() ä¹‹å‰è¢«è°ƒç”¨æ¥ä»è„šæœ¬ä¸­è·å–å¿…é¡»çš„ä¿¡æ¯ï¼š 12345678910111213function getSettings( &#123; template, style, script &#125; ) &#123; return &#123; template, style, script &#125;;&#125;[â€¦]function loadComponent( URL ) &#123; return fetchAndParse( URL ).then( getSettings ).then( registerComponent );&#125; ç›®å‰è¿™ä¸ªå‡½æ•°åªæ˜¯è¿”å›äº†æ‰€æœ‰ä¼ ç»™å®ƒçš„å‚æ•°ã€‚æˆ‘ä»¬è¦æŠŠä¸Šé¢æåˆ°çš„æ•´ä¸ªçš„é€»è¾‘æ·»åŠ è¿›å»ã€‚é¦–å…ˆï¼ŒæŠŠè„šæœ¬è½¬æˆ Object URIï¼š 12const jsFile = new Blob( [ script.textContent ], &#123; type: 'application/javascript' &#125; );const jsURL = URL.createObjectURL( jsFile ); ç„¶åï¼Œé€šè¿‡ import åŠ è½½å®ƒå¹¶è¿”å› templateï¼Œstyles å’Œä» &lt;script&gt; ä¸­æå–çš„ç»„ä»¶åç§°ã€‚ 1234567return import( jsURL ).then( ( module ) =&gt; &#123; return &#123; name: module.default.name, template, style &#125;&#125; ); å€ŸåŠ©äºæ­¤ï¼ŒregisterComponent() æ¥æ”¶çš„ 3 ä¸ªå‚æ•°é‡Œ &lt;script&gt; å˜æˆäº†ç»„ä»¶çš„åç§°ã€‚ä¿®æ”¹ä»£ç ï¼š 1234567function registerComponent( &#123; template, style, name &#125; ) &#123; class UnityComponent extends HTMLElement &#123; [â€¦] &#125; return customElements.define( name, UnityComponent );&#125; ï¼¼( ï½€âˆ€Â´)ï¼ VoilÃ ! è¡Œä¸ºå±‚ç»„ä»¶è¿˜æœ‰ä¸€éƒ¨åˆ†æ²¡å®Œæˆï¼šè¡Œä¸ºï¼Œå³å¤„ç†äº‹ä»¶ã€‚ç›®å‰ä½ åªèƒ½ä» getSettings() å‡½æ•°è·å–ç»„ä»¶çš„åå­—ï¼Œä½ è¿˜éœ€è¦è·å–äº‹ä»¶ç›‘å¬å™¨ã€‚Object.entries() å¯ä»¥ç”¨æ¥å®ç°è¿™ä¸ªç›®çš„ã€‚æˆ‘ä»¬å›åˆ° getSettings() ç»™å®ƒæ·»åŠ é€‚å½“ä»£ç ï¼š 1234567891011121314151617181920212223242526function getSettings( &#123; template, style, script &#125; ) &#123; [â€¦] function getListeners( settings ) &#123; // 1 const listeners = &#123;&#125;; Object.entries( settings ).forEach( ( [ setting, value ] ) =&gt; &#123; // 3 if ( setting.startsWith( 'on' ) ) &#123; // 4 listeners[ setting[ 2 ].toLowerCase() + setting.substr( 3 ) ] = value; // 5 &#125; &#125; ); return listeners; &#125; return import( jsURL ).then( ( module ) =&gt; &#123; const listeners = getListeners( module.default ); // 2 return &#123; name: module.default.name, listeners, // 6 template, style &#125; &#125; );&#125; å‡½æ•°å˜å¾—å¤æ‚äº†ã€‚å‡ºç°äº†æ–°çš„è¾…åŠ©å‡½æ•° getListeners() (1)ã€‚æ¨¡å—çš„ export è¢«ä¼ é€’ç»™å®ƒ(2)ã€‚ç„¶åä½¿ç”¨ Object.entries() éå†äº†è¿™ä¸ª export çš„æ‰€æœ‰å±æ€§(3)ã€‚å¦‚æœå½“å‰å±æ€§åä»¥ on... å¼€å¤´(4)ï¼Œå°±æŠŠè¿™ä¸ªå±æ€§çš„å€¼èµ‹ç»™ listeners å¯¹è±¡ï¼Œå¹¶æŠŠ setting[2].toLowerCase() + setting.substr(3) ä½œä¸ºå®ƒçš„å±æ€§å(5)ã€‚è¿™ä¸ªå±æ€§åæ˜¯é€šè¿‡å»æ‰ on å‰ç¼€åæŠŠé¦–å­—æ¯è½¬æ¢æˆå°å†™ï¼ˆè¿™æ · onClick ä¼šè¢«è½¬æ¢æˆ clickï¼‰å¾—åˆ°çš„ã€‚ç„¶åæŠŠ listeners å¯¹è±¡ä¼ å‡ºå»(6)ã€‚ å¯ä»¥ç”¨ [].reduce() ä»£æ›¿ [].forEach() æ¥å¤„ç† listeners å˜é‡ï¼š 123456789function getListeners( settings ) &#123; return Object.entries( settings ).reduce( ( listeners, [ setting, value ] ) =&gt; &#123; if ( setting.startsWith( 'on' ) ) &#123; listeners[ setting[ 2 ].toLowerCase() + setting.substr( 3 ) ] = value; &#125; return listeners; &#125;, &#123;&#125; );&#125; ç°åœ¨ä½ å¯ä»¥åœ¨ç»„ä»¶çš„ class ä¸­ç»‘å®šè¿™äº›ç›‘å¬å™¨äº†ï¼š 123456789101112131415161718function registerComponent( &#123; template, style, name, listeners &#125; ) &#123; // 1 class UnityComponent extends HTMLElement &#123; connectedCallback() &#123; this._upcast(); this._attachListeners(); // 2 &#125; [â€¦] _attachListeners() &#123; Object.entries( listeners ).forEach( ( [ event, listener ] ) =&gt; &#123; // 3 this.addEventListener( event, listener, false ); // 4 &#125; ); &#125; &#125; return customElements.define( name, UnityComponent );&#125; é‡æ„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªæ–°çš„å‚æ•° listeners (1)ï¼Œä»¥åŠ class ä¸­çš„ä¸€ä¸ªæ–°çš„æ–¹æ³• _attachListeners (2)ã€‚æˆ‘ä»¬åˆä¸€æ¬¡ç”¨åˆ°äº† Object.entries()--è¿™æ¬¡æ˜¯ç”¨æ¥éå† listeners (3) å¹¶æŠŠå®ƒä»¬ç»‘å®šåˆ°è¿™ä¸ªç»„ä»¶å…ƒç´ ä¸Š (4)ã€‚ åšå®Œè¿™äº›ä»¥åæˆ‘ä»¬çš„ç»„ä»¶åº”è¯¥ä¼šå“åº”ç‚¹å‡»äº‹ä»¶äº†ï¼š ç‚¹å‡»äº†è¿™ä¸ªç»„ä»¶ä»¥å Chrome å¼¹æ¡†æ˜¾ç¤ºï¼šâ€œDonâ€™t touch me!â€ ä»¥ä¸Šå°±æ˜¯å¦‚ä½•å®ç°ä¸€ä¸ªå•æ–‡ä»¶ Web Components ğŸ‰! æµè§ˆå™¨å…¼å®¹æ€§ä»¥åŠå…¶ä»–ä½ å¯ä»¥çœ‹å‡ºï¼Œå³ä½¿æ˜¯ä¸ºäº†æ”¯æŒä¸€ä¸ªæœ€ç®€å•å½¢å¼çš„å•æ–‡ä»¶ç»„ä»¶ï¼Œä¹Ÿéœ€è¦åšéå¸¸å¤šçš„å·¥ä½œã€‚æˆ‘ä»¬æ‰€å±•ç°çš„è¿™ä¸ªç³»ç»Ÿä¸­çš„è®¸å¤šéƒ¨åˆ†éƒ½æ˜¯ç”¨è„ hack å®ç°çš„ï¼ˆç”¨ Object URI æ¥åŠ è½½ ES æ¨¡å—ï¼Ÿ--ä»€ä¹ˆé¬¼ï¼ï¼‰è€Œä¸”å¦‚æœæ²¡æœ‰æµè§ˆå™¨çš„åŸç”Ÿæ”¯æŒï¼Œè¿™é¡¹æŠ€æœ¯ä¹Ÿæ²¡ä»€ä¹ˆæ„ä¹‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œåœ¨æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ˆ2018 å¹´ 8 æœˆï¼‰Firefox å¹¶ä¸æ”¯æŒ Custom Elements å’Œ dynamic importã€‚å¦ç™½è¯´è¿™ä¸œè¥¿ç°åœ¨åªåœ¨ Chrome é‡Œå¥½ä½¿ã€‚å› æ­¤--ç›®å‰æ¥è¯´--å®ƒåªæ˜¯ä¸ºäº†æ»¡è¶³ä¸€ä¸‹å¥½å¥‡å¿ƒï¼Œæ²¡ä»€ä¹ˆå®é™…ç”¨å¤„ã€‚ ä¸è¿‡å®ç°ä¸€ä¸ªè¿™æ ·çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¥½ç©çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¶‰åŠäº†è®¸å¤šæµè§ˆå™¨å¼€å‘å’Œç°ä»£ web æ ‡å‡†ç›¸å…³å†…å®¹çš„ä¸ä¼—ä¸åŒçš„å°ç©æ„å„¿ã€‚æˆ‘å¸Œæœ›è‡³å°‘èƒ½æœ‰ä¸€ä¸ªäººçœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼ å½“ç„¶äº†æ•´ä¸ªä½œå“å¯ä»¥åœ¨ç½‘ä¸Šé¢„è§ˆã€‚","link":"/2019/03/27/single-file-web-components/"},{"title":"ã€Œè¯‘ã€ç†è§£ JavaScript ä¸­çš„ Promise","text":"ä½œè€…ï¼šGokul N K åŸæ–‡é“¾æ¥ï¼šUnderstanding promises in JavaScript æˆ‘å¯¹ JavaScript çš„æ„Ÿè§‰æ˜¯â€œåˆçˆ±åˆæ¨â€ã€‚ä½†æ˜¯å®ƒè¿˜æ˜¯ä¸€ç›´å¸å¼•ç€æˆ‘ã€‚æˆ‘åšäº† 10 å¹´çš„ Java å’Œ PHP å¼€å‘ï¼Œç›¸è¾ƒä¹‹ä¸‹ï¼ŒJavaScript æ˜¯ä¸€ä¸ªéå¸¸ç‹¬ç‰¹è€Œæœ‰è¶£çš„å­˜åœ¨ã€‚ç°åœ¨æˆ‘æ­£åŠªåŠ›èŠ±æ—¶é—´æ¥äº†è§£æ›´å¤šçš„ JavaScript å†…å®¹ã€‚ æˆ‘é‡åˆ°çš„ç¬¬ä¸€ä¸ªæœ‰æ„æ€çš„ä¸»é¢˜å°±æ˜¯ Promiseã€‚æ›¾ç»ä¸æ­¢ä¸€æ¬¡çš„å¬äººä»¬è¯´èµ· Promise æŠŠä»–ä»¬ä»å›è°ƒåœ°ç‹±ä¸­æ‹¯æ•‘å‡ºæ¥ã€‚è€Œè¿™åªä¸è¿‡æ˜¯ Promise é¡ºå¸¦çš„ä¸€ç‚¹å¥½å¤„è€Œå·²ï¼ŒPromise åŒ…å«äº†æ›´å¤šçš„å†…å®¹ï¼Œç›´åˆ°ç°åœ¨æˆ‘æ‰æŠŠå®ƒææ¸…æ¥šã€‚è¿™æ˜¯ä¸€ç¯‡é•¿æ–‡ï¼Œå¦‚æœä½ æƒ³åšäº›é«˜äº®æ ‡è®°ä»€ä¹ˆçš„ï¼Œä½ å¯ä»¥è¯•è¯•æˆ‘ä»¬è¿™ä¸ªæ‰©å±• http://bit.ly/highlights-extension èƒŒæ™¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ JavaScript çš„æ—¶å€™ä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆå—æŒ«ã€‚ä½ å¯èƒ½ä¼šå¬åˆ°ä¸€äº›äººè¯´ JavaScript æ˜¯åŒæ­¥ç¼–ç¨‹è¯­è¨€è€Œå¦ä¸€äº›äººåˆ™è¯´å®ƒæ˜¯å¼‚æ­¥çš„ã€‚ä½ ä¼šå¬åˆ°è¯¸å¦‚é˜»å¡ä»£ç ã€éé˜»å¡ä»£ç ã€äº‹ä»¶é©±åŠ¨è®¾è®¡æ¨¡å¼ã€äº‹ä»¶ç”Ÿå‘½å‘¨æœŸã€å‡½æ•°æ ˆã€äº‹ä»¶é˜Ÿåˆ—ã€å†’æ³¡ã€polyfillã€babelã€angularã€reactJSã€VueJS ä»¥åŠä¸€å¤§å †çš„å·¥å…·å’Œåº“ã€‚åˆ«æ‹…å¿ƒï¼Œä½ ä¸æ˜¯ç¬¬ä¸€ä¸ªæ„Ÿè§‰å¤´æ˜è„‘èƒ€çš„äººã€‚æœ‰ä¸€ä¸ªä¸“é—¨çš„åè¯ï¼Œå«åš JavaScript Fatigueï¼ˆJS ç–²ä¹ï¼‰ã€‚è¿™æ¡æ¨ç‰¹æ€»ç»“çš„å¾ˆåˆ°ä½ã€‚ å¦‚æœä½ æƒ³äº†è§£å…³äº JS ç–²ä¹çš„æ›´å¤šç»†èŠ‚ï¼Œå¯ä»¥é˜…è¯»ä¸‹é¢è¿™ç¯‡æ–‡ç« ã€‚è¿™ç¯‡æ–‡ç« èƒ½åœ¨ Hackernoon ä¸Šè·å¾— 42000 æ¬¡é¼“æŒä¸æ˜¯æ²¡æœ‰åŸå› çš„ :) JavaScript æ˜¯ä¸€ä¸ªåŒæ­¥å‹çš„ç¼–ç¨‹è¯­è¨€ã€‚ä¸è¿‡å€ŸåŠ©äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒåƒå¼‚æ­¥ç¼–ç¨‹è¯­è¨€ä¸€æ ·æ‰§è¡Œã€‚ è®©é—¨å¤–æ±‰ç†è§£ PromiseJavaScript ä¸­çš„ Promise è·Ÿç°å®ç”Ÿæ´»ä¸­çš„ Promise éå¸¸åƒã€‚å› æ­¤æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹ç°å®ç”Ÿæ´»ä¸­çš„æ‰¿è¯ºï¼ˆPromiseï¼‰æ˜¯æ€æ ·çš„ã€‚ å­—å…¸ä¸­æ˜¯è¿™æ ·æè¿° Promise çš„ï¼š Promiseï¼š åè¯ï¼šæŸäººä¿è¯ä¼šåšæŸäº‹æˆ–åˆ™æŸä»¶äº‹ä¸€å®šä¼šå‘ç”Ÿã€‚ é‚£ä¹ˆå½“åˆ«äººå¯¹ä½ åšäº†æ‰¿è¯ºï¼ˆPromiseï¼‰ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ Promise æ˜¯å¯¹æŸäº‹ä¸€å®šä¼šå‘ç”Ÿçš„ä¿è¯ã€‚ä¸è®ºæ˜¯ï¼ˆä½œå‡ºä¿è¯ï¼‰çš„è¿™ä¸ªäººäº²è‡ªå»åšè¿˜æ˜¯äº¤ç”±ç¬¬ä¸‰æ–¹å»å®Œæˆã€‚ç„¶åä½ å°±å¯ä»¥åœ¨è¿™ä¸ªä¿è¯çš„åŸºç¡€ä¸Šåšä¸‹ä¸€æ­¥çš„è®¡åˆ’ã€‚ Promise ä¼šè¢«å®ç°æˆ–æ˜¯æ²¡èƒ½å®ç°ã€‚ å½“ Promise å®ç°æ—¶ï¼Œä¼šå¸¦å›æ¥æŸç§ç»“æœã€‚è¿™ä¸ªç»“æœå¯è¢«ç”¨äºä¸‹ä¸€æ­¥çš„è¡ŒåŠ¨ã€‚ å¦‚æœä¸€ä¸ª Promise æœªèƒ½æˆåŠŸå®ç°ï¼Œä½ ä¼šå¸Œæœ›äº†è§£ä¸ºä½•è¿™ä¸ªåšå‡ºæ‰¿è¯ºçš„äººæœªèƒ½å±¥è¡Œä»–çš„è¯ºè¨€ã€‚ä¸€æ—¦ä½ äº†è§£å¹¶ç¡®è®¤äº† Promise æ‰§è¡Œå¤±è´¥çš„åŸå› ï¼Œä½ å°±å¯ä»¥è®¡åˆ’æ¥ä¸‹æ¥å¦‚ä½•å¤„ç†å®ƒäº†ã€‚ åœ¨åšå‡º Promise çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°çš„åªæ˜¯ä¸€ä¸ªä¿è¯ã€‚é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬æš‚æ—¶ä»€ä¹ˆéƒ½åšä¸äº†ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥å…ˆè®¡åˆ’ä¸€ä¸‹å½“ Promise è¢«å®ç°ä»¥åï¼ˆå¾—åˆ°äº†æˆ‘ä»¬é¢„æœŸçš„ç»“æœï¼‰æˆ–æ˜¯ æœªèƒ½å®ç°ï¼ˆäº†è§£å¤±è´¥åŸå› å¹¶åˆ¶å®šåº”æ€¥é¢„æ¡ˆï¼‰æ—¶è¦åšä»€ä¹ˆã€‚ ä¸è¿‡ä¹Ÿæœ‰å¯èƒ½è¿™ä¸ªäººåœ¨è·Ÿä½ åšå®Œ Promise ä»¥åå°±æ³æ— éŸ³è®¯äº†ã€‚è¿™æ—¶å€™ä½ éœ€è¦è®¾ç½®ä¸€ä¸ªæ—¶é—´èŠ‚ç‚¹ã€‚æ¯”å¦‚è¯´å¦‚æœè¿™ä¸ªåšå‡ºæ‰¿è¯ºçš„äººåœ¨ 10 å¤©ä¹‹å†…æ²¡æœ‰å›æ¥æˆ‘å°†å‡è®¾ä»–é‡ä¸Šäº†ä»€ä¹ˆæ„å¤–æ— æ³•å®Œæˆæ‰¿è¯ºäº†ã€‚å› æ­¤å³ä½¿è¿™ä¸ªäººåœ¨ 15 å¤©ä¹‹åæ‰å›æ¥ä¹Ÿæ²¡ä»€ä¹ˆå¤§ä¸äº†ï¼Œå› ä¸ºä½ å·²ç»åˆ¶å®šäº†å¤‡ç”¨æ–¹æ¡ˆã€‚ JavaScript ä¸­çš„ Promiseæ ¹æ®ç»éªŒï¼Œæˆ‘æ€»æ˜¯ä» MDN Web Docs é˜…è¯» JavaScript çš„æ–‡æ¡£ã€‚æˆ‘è®¤ä¸ºå®ƒæœ€ä¸ºç²¾å‡†æƒå¨ã€‚æˆ‘é€šè¿‡é˜…è¯» MDN Web Docs ä¸Šçš„ Promise ç›¸å…³é¡µé¢ ä»¥åŠå†™ä»£ç å®è·µæ¥æŒæ¡å®ƒã€‚ ç†è§£ Promise åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚åˆ›å»º Promise å’Œ å¤„ç† Promiseã€‚å°½ç®¡å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ˜¯åœ¨å†™ä»£ç å¤„ç†å…¶ä»–åº“äº§ç”Ÿçš„ Promiseï¼Œå…¨é¢çš„å»äº†è§£ Promise è¿˜æ˜¯ä¼šå¾ˆæœ‰å¸®åŠ©çš„ã€‚å½“ä½ è¿ˆè¿‡åˆå­¦è€…é˜¶æ®µä»¥åä½ ä¼šå‘ç°äº†è§£â€œPromise çš„åˆ›å»ºâ€ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚ åˆ›å»º Promiseæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åˆ›å»º Promise çš„ä»£ç æ ¼å¼ã€‚ 1234new Promise( /* æ‰§è¡Œè€… */ function(resolve, reject) &#123; ... &#125; ); æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªåä¸ºæ‰§è¡Œè€…ï¼ˆexecutorï¼‰çš„å‡½æ•°ä½œä¸ºå‚æ•°ã€‚executor å‡½æ•°ä¾æ¬¡æ¥å—ä¸¤ä¸ªå‡½æ•°å‚æ•°ï¼šresolve å’Œ rejectã€‚Promise é€šå¸¸è¢«ç”¨æ¥ç®€åŒ–å¼‚æ­¥æ“ä½œæˆ–é˜»å¡æ€§ä»£ç çš„æ‰§è¡Œï¼Œè¿™ç§æ“ä½œä¸€èˆ¬å‡ºç°åœ¨æ–‡ä»¶æ“ä½œã€API è°ƒç”¨ã€æ•°æ®åº“è°ƒç”¨ã€IO è°ƒç”¨ç­‰æƒ…æ™¯ä¸­ã€‚è¿™äº›å¼‚æ­¥æ“ä½œçš„åˆå§‹åŒ–åœ¨ executor å‡½æ•°ä¸­å®Œæˆã€‚å¦‚æœå¼‚æ­¥æ“ä½œæˆåŠŸå®Œæˆï¼ŒPromise çš„åˆ›å»ºè€…ä¼šè°ƒç”¨ resolve å‡½æ•°æ¥è¿”å›æ“ä½œç»“æœã€‚ç±»ä¼¼çš„ï¼Œè‹¥å› ä¸ºå‘ç”Ÿäº†é”™è¯¯æ— æ³•å®Œæˆæ“ä½œï¼Œå¤±è´¥åŸå› ä¼šé€šè¿‡è°ƒç”¨ reject å‡½æ•°è¿”å›ã€‚ ç°åœ¨æˆ‘ä»¬å·²ç»å­¦ä¼šå¦‚ä½•åˆ›å»º Promise äº†ã€‚æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ Promise æ¥å¸®åŠ©åŠ æ·±ç†è§£ã€‚ 12345678910var keepsHisWord;keepsHisWord = true;promise1 = new Promise(function(resolve, reject) &#123; if (keepsHisWord) &#123; resolve(\"The man likes to keep his word\"); &#125; else &#123; reject(\"The man doesnt want to keep his word\"); &#125;&#125;);console.log(promise1); ç”±äºè¿™ä¸ª Promise åœ¨åˆ›å»ºåç«‹åˆ»å°±è¢«è§£å†³äº†ï¼ˆresolvedï¼‰ï¼Œæˆ‘ä»¬æ— æ³•æ£€æµ‹å®ƒçš„åˆå§‹çŠ¶æ€ã€‚æ‰€ä»¥æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰ä¼šè¢« resolved çš„ Promiseã€‚æœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨ setTimeout å‡½æ•°ã€‚ 123456789promise2 = new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; resolve(&#123; message: \"The man likes to keep his word\", code: \"aManKeepsHisWord\" &#125;); &#125;, 10 * 1000);&#125;);console.log(promise2); ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªä¼šåœ¨ 10 ç§’é’Ÿå resolve çš„ Promiseã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å®ƒ resolve ä¹‹å‰æŸ¥çœ‹ Promise çŠ¶æ€ã€‚ 10 ç§’ç§å Promise è¢« resolveã€‚PromiseStatus å’Œ PromiseValue ä¹Ÿéšä¹‹è¢«æ›´æ–°ã€‚å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬ä¿®æ”¹äº† resolve å‡½æ•°ä»¥ä¾¿ä¼ ç»™å®ƒä¸€ä¸ª JSON å¯¹è±¡è€Œä¸ä»…ä»…æ˜¯ç®€å•çš„æ–‡æœ¬ã€‚è¿™æ˜¯ä¸ºäº†å±•ç°å‡ºæˆ‘ä»¬å¯ä»¥å‘ resovle å‡½æ•°ä¼ é€’ä¸åŒçš„å€¼ã€‚ ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¢«é©³å›ï¼ˆrejectï¼‰çš„ Promiseã€‚æˆ‘ä»¬å¯¹ Promise 1 åšä¸€ç‚¹å°å°çš„ä¿®æ”¹ã€‚ 123456789keepsHisWord = false;promise3 = new Promise(function(resolve, reject) &#123; if (keepsHisWord) &#123; resolve(\"The man likes to keep his word\"); &#125; else &#123; reject(\"The man doesn't want to keep his word\"); &#125;&#125;);console.log(promise3); ç”±äºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæœªå¤„ç†çš„ rejectionï¼ŒChrome æµè§ˆå™¨ä¼šæ˜¾ç¤ºä¸€ä¸ªé”™è¯¯ã€‚ç›®å‰ä½ å¯ä»¥å…ˆæŠŠå®ƒå¿½ç•¥ï¼Œæˆ‘ä»¬åé¢ä¼šå¤„ç†è¿™ä¸ªé”™è¯¯ã€‚ æˆ‘ä»¬çœ‹åˆ°ï¼ŒPromiseStatus å¯ä»¥æœ‰ä¸åŒçš„å€¼ï¼špendingã€resolved æˆ– rejectedã€‚åœ¨ Promise åˆ›å»ºæ—¶ï¼ŒPromiseStatus å¤„äº pending çŠ¶æ€ï¼Œå¹¶ä¸” PromiseValue çš„å€¼åœ¨ Promise è¢« resolved æˆ– rejected ä¹‹å‰ä¸€ç›´éƒ½æ˜¯ undefinedã€‚å½“ä¸€ä¸ª Promise å¤„äº resolved æˆ– rejected çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ª Promise è¢«è§£å†³äº†ï¼ˆsettledï¼‰ã€‚æ‰€ä»¥é€šå¸¸æ¥è¯´ï¼ŒPromise ä¼šä» pending çŠ¶æ€å˜æˆ settled çŠ¶æ€ã€‚ ç°åœ¨æˆ‘ä»¬çŸ¥é“ Promise æ˜¯å¦‚ä½•åˆ›å»ºçš„äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å¦‚ä½•å¤„ç† Promiseã€‚è¿™å„¿ä¼šæ‰‹æŠŠæ‰‹çš„æ•™ä½ ç†è§£ Promise å¯¹è±¡ã€‚ ç†è§£ Promise å¯¹è±¡æ® MDN æ–‡æ¡£ Promise å¯¹è±¡ä»£è¡¨ä¸€ä¸ªæœ€ç»ˆä¼šå®ç°ï¼ˆæˆ–å¤±è´¥ï¼‰çš„å¼‚æ­¥æ“ä½œï¼Œä»¥åŠè¿™ä¸ªæ“ä½œçš„è¿”å›å€¼ã€‚ Promise å¯¹è±¡æ‹¥æœ‰é™æ€æ–¹æ³•ä»¥åŠ åŸå‹æ–¹æ³•ã€‚Promiseå¯¹è±¡ä¸­çš„é™æ€æ–¹æ³•å¯ä»¥ç‹¬ç«‹åº”ç”¨ï¼Œè€ŒåŸå‹æ–¹æ³•éœ€è¦åº”ç”¨äºPromiseå¯¹è±¡çš„å®ä¾‹ã€‚è®°ä½æ™®é€šæ–¹æ³•å’ŒåŸå‹æ–¹æ³•éƒ½æ˜¯è¿”å›ä¸€ä¸ª Promise ä¼šå¯¹ä½ çš„å­¦ä¹ æœ‰æ‰€å¸®åŠ©ã€‚ åŸå‹æ–¹æ³•æˆ‘ä»¬å…ˆä»ä¸‰ä¸ªåŸå‹æ–¹æ³•å¼€å§‹ã€‚é‡ç”³ä¸€ä¸‹ï¼Œæ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½å¯ä»¥ç”¨äº Promise å¯¹è±¡çš„å®ä¾‹è€Œä¸”æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½ä¼šä¾æ¬¡è¿”å›ä¸€ä¸ª Promiseã€‚å‰é¢æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼ŒPromise åœ¨åˆšåˆ›å»ºæ—¶æ˜¯å¤„äº pending çŠ¶æ€ã€‚åœ¨ Promise è¢«è§£å†³ï¼ˆsettledï¼‰ä»¥åï¼Œæ ¹æ®å®ƒçš„çŠ¶æ€æ˜¯ fulfilled æˆ– rejectedï¼Œä¸‹é¢çš„æŸä¸€ä¸ªæ–¹æ³•ä¼šè¢«æ‰§è¡Œã€‚ Promise.prototype.catch(onRejected) Promise.prototype.then(onFulfilled, onRejected) Promise.prototype.finally(onFinally) ä¸‹é¢çš„å›¾ç‰‡å±•ç¤ºäº† then å’Œ catch æ–¹æ³•çš„æµç¨‹ã€‚å›¾ç‰‡ä¸­ä¹Ÿæ˜¾ç¤ºäº†ç”±äºè¿™äº›æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å› æ­¤å¯ä»¥è¢«ç»§ç»­é“¾ä¸‹å»ã€‚å½“åœ¨ Promise ä¸Šåº”ç”¨äº† .finally æ—¶ï¼Œæ— è®ºè¿™ä¸ª Promise çš„è§£å†³çŠ¶æ€æ˜¯ fulfilled è¿˜æ˜¯ rejectedï¼Œå®ƒéƒ½ä¼šæ‰§è¡Œã€‚ Konstantin Rouda æŒ‡å‡º finally å¾—åˆ°çš„æ”¯æŒéå¸¸æœ‰é™ï¼Œå› æ­¤åœ¨ä½¿ç”¨å®ƒæ—¶è¯·æ— æ¯”åšå¥½æ£€æµ‹ã€‚ æ¥æºï¼šhttps://mdn.mozillademos.org/files/15911/promises.png è®²ä¸ªå°æ•…äº‹ã€‚ä½ æ˜¯ä¸€ä¸ªä¸Šå­¦çš„å­©å­ï¼Œæ­£åœ¨è·Ÿä½ å¦ˆè¦ä¸€éƒ¨æ‰‹æœºã€‚å¥¹è¯´ï¼šâ€œæœˆåº•å‰æˆ‘å°±ç»™ä½ ä¹°ä¸€éƒ¨ã€‚â€ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ç”¨ JavaScript æ¥æè¿°è¿™ä¸ªè¯ºè¨€åœ¨æœˆåº•å‰è¢«æ‰§è¡Œã€‚ 1234567891011121314151617181920212223242526var momsPromise = new Promise(function(resolve, reject) &#123; momsSavings = 20000; priceOfPhone = 60000; if (momsSavings &gt; priceOfPhone) &#123; resolve(&#123; brand: \"iphone\", model: \"6s\" &#125;); &#125; else &#123; reject(\"We donot have enough savings. Let us save some more money.\"); &#125;&#125;);momsPromise.then(function(value) &#123; console.log(\"Hurray I got this phone as a gift \", JSON.stringify(value));&#125;);momsPromise.catch(function(reason) &#123; console.log(\"Mom coudn't buy me the phone because \", reason);&#125;);momsPromise.finally(function() &#123; console.log( \"Irrespecitve of whether my mom can buy me a phone or not, I still love her\" );&#125;); è¾“å‡ºç»“æœä¸ºï¼š å¦‚æœæˆ‘ä»¬æŠŠ momsSavings çš„å€¼è®¾ç½®ä¸º 200000ï¼Œé‚£ä¹ˆå¦ˆå¦ˆå°±æœ‰è¶³å¤Ÿçš„é’±ç»™å„¿å­ä¹°ç¤¼ç‰©äº†ã€‚è¿™æ—¶è¾“å‡ºå¦‚ä¸‹ï¼š æˆ‘ä»¬æ¥å‡è£…æ˜¯è¿™ä¸ªåº“çš„ç”¨æˆ·ã€‚é€šè¿‡æ¨¡æ‹Ÿå®ƒçš„ç‰¹æ€§å’Œè¾“å‡ºæ¥ç ”ç©¶å¦‚ä½•æœ‰æ•ˆçš„ä½¿ç”¨å®ƒå¹¶æ•è·é”™è¯¯ã€‚ ç”±äº onFullfilledï¼ŒonRejected å¤„ç†å‡½æ•°éƒ½å¯ä»¥ç”± .then æ¥å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™ç§å†™æ³•æ¥ä»£æ›¿æŠŠ .then å’Œ .catch åˆ†å¼€å†™çš„åšæ³•ã€‚ 12345678momsPromise.then( function(value) &#123; console.log(\"Hurray I got this phone as a gift \", JSON.stringify(value)); &#125;, function(reason) &#123; console.log(\"Mom coudn't buy me the phone because \", reason); &#125;); ä¸è¿‡ä»å¯è¯»æ€§çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—åˆ†å¼€å†™æ¯”è¾ƒå¥½ã€‚ ä¸ºäº†ç¡®ä¿ä¸Šé¢æ‰€æœ‰çš„ä¾‹å­éƒ½èƒ½åœ¨å¸¸è§æµè§ˆå™¨æˆ– Chrome ä¸­æ‰§è¡Œï¼Œæˆ‘çš„ä»£ç ä¸­æ²¡æœ‰ä»»ä½•å¤–éƒ¨ä¾èµ–ã€‚ä¸ºäº†åŠ æ·±å¯¹ä¸»é¢˜çš„ç†è§£ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªä¼šè¿”å› Promise çš„å‡½æ•°ï¼Œè¿™ä¸ª Promise ä¼šè¢«éšæœºçš„æˆåŠŸæ‰§è¡Œï¼ˆresolvedï¼‰æˆ–æ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸åŒçš„æƒ…å¢ƒä¸‹æµ‹è¯•æˆ‘ä»¬çš„ä»£ç ã€‚ä¸ºäº†ç†è§£å¼‚æ­¥å‡½æ•°è¿™ä¸€æ¦‚å¿µï¼Œæˆ‘ä»¬çš„ä»£ç ä¸­è¿˜å°†åŠ å…¥éšæœºçš„å»¶è¿Ÿã€‚æ—¢ç„¶ç”¨åˆ°äº†éšæœºï¼Œæˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªéšæœºè¿”å›åœ¨ X å’Œ Y ä¹‹é—´çš„æ•°å€¼çš„å‡½æ•°ã€‚ 1234function getRandomNumber(start = 1, end = 10) &#123; //works when both start,end are &gt;=1 and end &gt; start return parseInt(Math.random() * end) % (end-start+1) + start;&#125; æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªè¿”å› Promise çš„å‡½æ•°ã€‚æˆ‘ä»¬è°ƒç”¨ä¸€ä¸‹å‡½æ•° promiseTRRARNOSGï¼Œå®ƒæ˜¯å‡½æ•° promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator çš„åˆ«åã€‚è¿™ä¸ªå‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªåœ¨ 2 åˆ° 10 ç§’åè¢«æˆåŠŸæ‰§è¡Œï¼ˆresolvedï¼‰æˆ–æ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰çš„ Promiseã€‚ä¸ºäº†ä½¿è¿™ä¸ª Promise çš„æ‰§è¡ŒæˆåŠŸ/å¤±è´¥éšæœºåŒ–ï¼Œæˆ‘ä»¬ä¼šéšæœºç”Ÿæˆä¸€ä¸ªä½äº 1 åˆ° 10 ä¹‹é—´çš„æ•°å­—ï¼Œå¦‚æœæ•°å­—å¤§äº 5ï¼Œæˆ‘ä»¬å°±è®©è¿™ä¸ª Promise æˆåŠŸæ‰§è¡Œï¼ˆresolvedï¼‰ï¼Œå¦åˆ™å°±è®©å®ƒæ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344function getRandomNumber(start = 1, end = 10) &#123; //works when both start and end are &gt;=1 return (parseInt(Math.random() * end) % (end - start + 1)) + start;&#125;var promiseTRRARNOSG = (promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator = function() &#123; return new Promise(function(resolve, reject) &#123; let randomNumberOfSeconds = getRandomNumber(2, 10); setTimeout(function() &#123; let randomiseResolving = getRandomNumber(1, 10); if (randomiseResolving &gt; 5) &#123; resolve(&#123; randomNumberOfSeconds: randomNumberOfSeconds, randomiseResolving: randomiseResolving &#125;); &#125; else &#123; reject(&#123; randomNumberOfSeconds: randomNumberOfSeconds, randomiseResolving: randomiseResolving &#125;); &#125; &#125;, randomNumberOfSeconds * 1000); &#125;);&#125;);var testProimse = promiseTRRARNOSG();testProimse.then(function(value) &#123; console.log(\"Value when promise is resolved : \", value);&#125;);testProimse.catch(function(reason) &#123; console.log(\"Reason when promise is rejected : \", reason);&#125;);// Let us loop through and create ten different promises using the function to see some variation. Some will be resolved and some will be rejected. for (i=1; i&lt;=10; i++) &#123; let promise = promiseTRRARNOSG(); promise.then(function(value) &#123; console.log(\"Value when promise is resolved : \", value); &#125;); promise.catch(function(reason) &#123; console.log(\"Reason when promise is rejected : \", reason); &#125;);&#125; åˆ·æ–°æµè§ˆå™¨å¹¶åœ¨ console ä¸­æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œä»¥ä¾¿æŸ¥çœ‹ Promise åœ¨ resolve å’Œ reject åœºæ™¯ä¸‹çš„è¾“å‡ºæƒ…å†µã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åœ¨ä¸å†™å¦‚æ­¤å¤šçš„å¤æ‚ä»£ç çš„æƒ…å†µä¸‹åˆ›å»ºå¤šä¸ª Promise å¹¶æ£€æŸ¥å®ƒä»¬çš„è¾“å‡ºã€‚ é™æ€æ–¹æ³•Promise å¯¹è±¡æœ‰ 4 ä¸ªé™æ€æ–¹æ³•ã€‚ å‰ä¸¤ä¸ªæ˜¯è¾…åŠ©æ–¹æ³•ï¼Œæˆ–è€…å«å¿«æ·æ–¹å¼ã€‚ç”¨å®ƒä»¬å¯ä»¥å¿«é€Ÿåˆ›å»ºè¢«æˆåŠŸæ‰§è¡Œï¼ˆresolvedï¼‰æˆ–æ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰çŠ¶æ€çš„ Promiseã€‚ ä»£ç  Promise.reject(reason) å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰çŠ¶æ€çš„ Promiseã€‚ 1234567var promise3 = Promise.reject(\"Not interested\");promise3.then(function(value)&#123; console.log(\"This will not run as it is a resolved promise. The resolved value is \", value);&#125;);promise3.catch(function(reason)&#123; console.log(\"This run as it is a rejected promise. The reason is \", reason);&#125;); ä»£ç  Promise.resolve(value) å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ‰§è¡ŒæˆåŠŸï¼ˆresolvedï¼‰çŠ¶æ€çš„ Promiseã€‚ 1234567var promise4 = Promise.resolve(1);promise4.then(function(value)&#123; console.log(\"This will run as it is a resovled promise. The resolved value is \", value);&#125;);promise4.catch(function(reason)&#123; console.log(\"This will not run as it is a resolved promise\", reason);&#125;); é¡ºå¸¦è¯´ä¸€ä¸‹ï¼Œä¸€ä¸ª Promise å¯ä»¥æœ‰å¤šä¸ªå¤„ç†å‡½æ•°ã€‚æ‰€ä»¥ä¸Šé¢çš„ä»£ç è¿˜å¯ä»¥è¿™æ ·å†™ï¼š 12345678910var promise4 = Promise.resolve(1);promise4.then(function(value)&#123; console.log(\"This will run as it is a resovled promise. The resolved value is \", value);&#125;);promise4.then(function(value)&#123; console.log(\"This will also run as multiple handlers can be added. Printing twice the resolved value which is \", value * 2);&#125;);promise4.catch(function(reason)&#123; console.log(\"This will not run as it is a resolved promise\", reason);&#125;); è¾“å‡ºç»“æœä¸ºï¼š æ¥ä¸‹æ¥çš„ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©ä½ å¤„ç†å¤šä¸ª Promiseã€‚å½“ä½ è¦å¤„ç†å¤šä¸ª Promise æ—¶ï¼Œæœ€å¥½æ˜¯å…ˆåˆ›å»ºä¸€ä¸ª Promise çš„æ•°ç»„ï¼Œç„¶åå¯¹è¿™ä¸ªæ•°ç»„é‡‡å–ç›¸åº”çš„æ“ä½œã€‚è¿™æ¬¡æˆ‘ä»¬ä¸èƒ½ç”¨ promiseTRRARNOSG è¿™ä¸ªå‡½æ•°åšä¾‹å­äº†ï¼Œå› ä¸ºå®ƒå¤ªéšæœºï¼Œå¯¹ä¸ç†è§£æˆ‘ä»¬è¦è¯´çš„å†…å®¹æ— ç›Šã€‚åœ¨è¿™é‡Œç”¨å¯ä»¥é¢„æµ‹å…¶è¡Œä¸ºçš„ Promise æ¯”è¾ƒé€‚åˆã€‚æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªä¼šåœ¨ n ç§’åæ‰§è¡ŒæˆåŠŸï¼ˆresolveï¼‰ï¼Œå¦ä¸€ä¸ªä¼šåœ¨ n ç§’åæ‰§è¡Œå¤±è´¥ï¼ˆrejectï¼‰ã€‚ 12345678910111213141516171819202122var promiseTRSANSG = (promiseThatResolvesAfterNSecondsGenerator = function( n = 0) &#123; return new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; resolve(&#123; resolvedAfterNSeconds: n &#125;); &#125;, n * 1000); &#125;);&#125;);var promiseTRJANSG = (promiseThatRejectsAfterNSecondsGenerator = function( n = 0) &#123; return new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; reject(&#123; rejectedAfterNSeconds: n &#125;); &#125;, n * 1000); &#125;);&#125;); æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸¤ä¸ªè¾…åŠ©å‡½æ•°æ¥ç†è§£ Promise.Allã€‚ Promise.Allæ® MDN æ–‡æ¡£ Promise.all(iterable) æ–¹æ³•è¿”å›ä¸€ä¸ª Promise å®ä¾‹ï¼Œæ­¤å®ä¾‹åœ¨ iterable å‚æ•°å†…æ‰€æœ‰çš„ promise éƒ½â€œå®Œæˆï¼ˆresolvedï¼‰â€æˆ–å‚æ•°ä¸­ä¸åŒ…å« promise æ—¶å›è°ƒå®Œæˆï¼ˆresolveï¼‰ï¼›å¦‚æœå‚æ•°ä¸­ promise æœ‰ä¸€ä¸ªå¤±è´¥ï¼ˆrejectedï¼‰ï¼Œæ­¤å®ä¾‹å›è°ƒå¤±è´¥ï¼ˆrejectï¼‰ï¼Œå¤±è´¥åŸå› çš„æ˜¯ç¬¬ä¸€ä¸ªå¤±è´¥ promise çš„ç»“æœã€‚ æ¡ˆä¾‹ 1ï¼šæ‰€æœ‰çš„ Promise éƒ½æˆåŠŸæ‰§è¡Œï¼ˆresolvedï¼‰ã€‚è¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„åœºæ™¯ã€‚ 12345678910111213console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(promiseTRSANSG(1));promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(2));var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.log(\"One of the promises failed with the following reason\", reason);&#125;); ä»è¾“å‡ºç»“æœä¸­æˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸¤ä¸ªéå¸¸é‡è¦çš„ç‚¹ã€‚ ç¬¬ä¸€ç‚¹ï¼šç¬¬ 3 ä¸ª Promise èŠ±äº† 2 ç§’æ‰§è¡Œå®Œæ¯•ï¼Œå®ƒæ¯”èŠ±äº† 4 ç§’é’Ÿæ‰æ‰§è¡Œå®Œæ¯•çš„ ç¬¬ 2 ä¸ª Promise è¦æ—©ã€‚ä½†æ˜¯ä½ ä»è¾“å‡ºç»“æœä¸­çœ‹åˆ°ï¼Œè¿”å›å€¼çš„é¡ºåºä¸ Promise åœ¨æ•°ç»„ä¸­çš„é¡ºåºæ˜¯ä¸€è‡´çš„ã€‚ ç¬¬äºŒç‚¹ï¼šæˆ‘åŠ äº†ä¸€ä¸ª console è®¡æ—¶å™¨æ¥è®¡ç®— Promise.All èŠ±è´¹äº†å¤šé•¿æ—¶é—´ã€‚å¦‚æœ Promise ä»¬æ˜¯ä¾æ¬¡æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆèŠ±è´¹çš„æ—¶é—´åº”è¯¥æ˜¯ 1+4+2=7 ç§’ã€‚ç„¶è€Œä»æˆ‘ä»¬çš„è®¡æ—¶å™¨çœ‹åˆ°ï¼Œå®ƒåªèŠ±äº† 4 ç§’ã€‚è¿™è¯æ˜æ‰€æœ‰çš„ Promise æ˜¯å¹³è¡Œæ‰§è¡Œçš„ã€‚ æ¡ˆä¾‹ 2ï¼šæ²¡æœ‰ä»»ä½• Promiseã€‚æˆ‘æƒ³è¿™ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šå‡ºç°ã€‚ 12345678910111213console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(1);promisesArray.push(4);promisesArray.push(2);var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.log(\"One of the promises failed with the following reason\", reason);&#125;); ç”±äºæ•°ç»„ä¸­æ²¡æœ‰ Promiseï¼Œæ‰€ä»¥è¿”å›çš„ Promise æ˜¯æ‰§è¡ŒæˆåŠŸï¼ˆresolvedï¼‰çŠ¶æ€ã€‚ æ¡ˆä¾‹ 3ï¼šå¤±è´¥ä¿¡æ¯æ˜¯æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ‰§è¡Œå¤±è´¥çš„ Promise çš„ä¿¡æ¯ 12345678910111213141516console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(promiseTRSANSG(1));promisesArray.push(promiseTRSANSG(5));promisesArray.push(promiseTRSANSG(3));promisesArray.push(promiseTRJANSG(2));promisesArray.push(promiseTRSANSG(4));var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.timeEnd(\"Promise.All\"); console.log(\"One of the promises failed with the following reason \", reason);&#125;); Promise.raceæ® MDN æ–‡æ¡£ï¼š Promise.race(iterable) æ–¹æ³•è¿”å›ä¸€ä¸ª promiseï¼Œä¸€æ—¦è¿­ä»£å™¨ä¸­çš„æŸä¸ªpromiseè§£å†³æˆ–æ‹’ç»ï¼Œè¿”å›çš„ promiseå°±ä¼šè§£å†³æˆ–æ‹’ç»ã€‚ æ¡ˆä¾‹ 1ï¼šæŸä¸ª Promise ç‡å…ˆæ‰§è¡ŒæˆåŠŸï¼ˆresolvedï¼‰ 12345678910111213141516console.time(\"Promise.race\");var promisesArray = [];promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(3));promisesArray.push(promiseTRSANSG(2));promisesArray.push(promiseTRJANSG(3));promisesArray.push(promiseTRSANSG(4));var promisesRace = Promise.race(promisesArray);promisesRace.then(function(values) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fasted promise resolved\", values);&#125;);promisesRace.catch(function(reason) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fastest promise rejected with the following reason \", reason);&#125;); æ‰€æœ‰çš„ Promise éƒ½æ˜¯å¹³è¡Œæ‰§è¡Œçš„ã€‚ç¬¬ 3 ä¸ª Promise ç”¨ 2 ç§’æ‰§è¡ŒæˆåŠŸï¼ˆresolvedï¼‰ï¼Œè¿™ä¸ª Promise æ‰§è¡Œå®Œæˆå Promise.race è¿”å›çš„ Promise å°±æ‰§è¡ŒæˆåŠŸäº†ï¼ˆresolvedï¼‰ã€‚ æ¡ˆä¾‹ 2ï¼šæŸä¸ª Promise ç‡å…ˆæ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰ 12345678910111213141516console.time(\"Promise.race\");var promisesArray = [];promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(6));promisesArray.push(promiseTRSANSG(5));promisesArray.push(promiseTRJANSG(3));promisesArray.push(promiseTRSANSG(4));var promisesRace = Promise.race(promisesArray);promisesRace.then(function(values) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fasted promise resolved\", values);&#125;);promisesRace.catch(function(reason) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fastest promise rejected with the following reason \", reason);&#125;); æ‰€æœ‰çš„ Promise éƒ½æ˜¯å¹³è¡Œæ‰§è¡Œçš„ã€‚ç¬¬ 4 ä¸ª Promise ç”¨æ—¶ 3 ç§’æ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰ï¼Œåœ¨å®ƒæ‰§è¡Œå®Œæˆå Promise.race è¿”å›çš„ Promise å°±æ‰§è¡Œå¤±è´¥ï¼ˆrejectedï¼‰äº†ã€‚ æˆ‘å†™äº†è¿™äº›ä¾‹å­ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œå¹¶æµ‹è¯•ä¸åŒçš„åœºæ™¯ã€‚å› æ­¤ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ä»»ä½•å¤–éƒ¨çš„ APIã€æ–‡ä»¶æ“ä½œæˆ–æ•°æ®åº“è°ƒç”¨ï¼Œå› ä¸ºå¦‚æœé‚£æ ·çš„è¯ä½ å°±å¾—åšä¸€äº›é¢å¤–çš„æ“ä½œæ¥ä½¿ç¤ºä¾‹ä»£ç è¿è¡Œäº†ã€‚æˆ‘ä»¬æ˜¯ç”¨å»¶è¿Ÿå‡½æ•°æ¥æ¨¡æ‹Ÿä¸åŒçš„åœºæ™¯ï¼Œè¿™ä¸éœ€è¦ä½ åšé¢å¤–çš„è®¾ç½®ã€‚ä½ è¿˜å¯ä»¥æ–¹ä¾¿çš„ä¿®æ”¹ç›¸å…³æ•°å€¼æ¥æ¨¡æ‹Ÿä¸åŒçš„æƒ…å†µã€‚é€šè¿‡ç»“åˆä½¿ç”¨ promiseTRJANSGã€promiseTRSANSG å’Œ promiseTRRARNOSG æ–¹æ³•å¯ä»¥æ¨¡æ‹Ÿè¶³å¤Ÿå¤šçš„åœºæ™¯ï¼Œä»¥ä¾¿å¯¹ Promise æœ‰æ›´å¥½çš„ç†è§£ã€‚åŒæ—¶é€šè¿‡åœ¨æœ‰å…³ä»£ç å—çš„å‰åä½¿ç”¨ console.time æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„è¯†åˆ«å‡º Promise æ˜¯å¹³è¡Œæ‰§è¡Œè¿˜æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚å¦‚æœä½ è¿˜æœ‰æŸäº›ç‰¹æ®Šçš„åœºæ™¯æˆ‘æ²¡æœ‰æåˆ°ï¼Œè¯·è”ç³»æˆ‘ã€‚ä¸Šé¢ç”¨åˆ°çš„æ‰€æœ‰ä»£ç éƒ½é›†åˆåœ¨è¿™ä¸ª gist é‡Œäº†ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243var keepsHisWord;keepsHisWord = true;promise1 = new Promise(function(resolve, reject) &#123; if (keepsHisWord) &#123; resolve(\"The man likes to keep his word\"); &#125; else &#123; reject(\"The man doesnt want to keep his word\"); &#125;&#125;);console.log(promise1);promise2 = new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; resolve(&#123; message: \"The man likes to keep his word\", code: \"aManKeepsHisWord\" &#125;); &#125;, 10 * 1000);&#125;);console.log(promise2);keepsHisWord = false;promise3 = new Promise(function(resolve, reject) &#123; if (keepsHisWord) &#123; resolve(\"The man likes to keep his word\"); &#125; else &#123; reject(\"The man doesn't want to keep his word\"); &#125;&#125;);console.log(promise3);var momsPromise = new Promise(function(resolve, reject) &#123; momsSavings = 20000; priceOfPhone = 60000; if (momsSavings &gt; priceOfPhone) &#123; resolve(&#123; brand: \"iphone\", model: \"6s\" &#125;); &#125; else &#123; reject(\"We donot have enough savings. Let us save some more money.\"); &#125;&#125;);momsPromise.then(function(value) &#123; console.log(\"Hurray I got this phone as a gift \", JSON.stringify(value));&#125;);momsPromise.catch(function(reason) &#123; console.log(\"Mom coudn't buy me the phone because \", reason);&#125;);momsPromise.finally(function() &#123; console.log( \"Irrespecitve of whether my mom can buy me a phone or not, I still love her\" );&#125;);momsPromise.then( function(value) &#123; console.log(\"Hurray I got this phone as a gift \", JSON.stringify(value)); &#125;, function(reason) &#123; console.log(\"Mom coudn't buy me the phone because \", reason); &#125;);function getRandomNumber(start = 1, end = 10) &#123; //works when both start,end are &gt;=1 and end &gt; start return parseInt(Math.random() * end) % (end-start+1) + start;&#125;function getRandomNumber(start = 1, end = 10) &#123; //works when both start and end are &gt;=1 return (parseInt(Math.random() * end) % (end - start + 1)) + start;&#125;var promiseTRRARNOSG = (promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator = function() &#123; return new Promise(function(resolve, reject) &#123; let randomNumberOfSeconds = getRandomNumber(2, 10); setTimeout(function() &#123; let randomiseResolving = getRandomNumber(1, 10); if (randomiseResolving &gt; 5) &#123; resolve(&#123; randomNumberOfSeconds: randomNumberOfSeconds, randomiseResolving: randomiseResolving &#125;); &#125; else &#123; reject(&#123; randomNumberOfSeconds: randomNumberOfSeconds, randomiseResolving: randomiseResolving &#125;); &#125; &#125;, randomNumberOfSeconds * 1000); &#125;);&#125;);var testProimse = promiseTRRARNOSG();testProimse.then(function(value) &#123; console.log(\"Value when promise is resolved : \", value);&#125;);testProimse.catch(function(reason) &#123; console.log(\"Reason when promise is rejected : \", reason);&#125;);// Let us loop through and create ten different promises using the function to see some variation. Some will be resolved and some will be rejected. for (i=1; i&lt;=10; i++) &#123; let promise = promiseTRRARNOSG(); promise.then(function(value) &#123; console.log(\"Value when promise is resolved : \", value); &#125;); promise.catch(function(reason) &#123; console.log(\"Reason when promise is rejected : \", reason); &#125;);&#125;var promise3 = Promise.reject(\"Not interested\");promise3.then(function(value)&#123; console.log(\"This will not run as it is a resolved promise. The resolved value is \", value);&#125;);promise3.catch(function(reason)&#123; console.log(\"This run as it is a rejected promise. The reason is \", reason);&#125;);var promise4 = Promise.resolve(1);promise4.then(function(value)&#123; console.log(\"This will run as it is a resovled promise. The resolved value is \", value);&#125;);promise4.catch(function(reason)&#123; console.log(\"This will not run as it is a resolved promise\", reason);&#125;);var promise4 = Promise.resolve(1);promise4.then(function(value)&#123; console.log(\"This will run as it is a resovled promise. The resolved value is \", value);&#125;);promise4.then(function(value)&#123; console.log(\"This will also run as multiple handlers can be added. Printing twice the resolved value which is \", value * 2);&#125;);promise4.catch(function(reason)&#123; console.log(\"This will not run as it is a resolved promise\", reason);&#125;);var promiseTRSANSG = (promiseThatResolvesAfterNSecondsGenerator = function( n = 0) &#123; return new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; resolve(&#123; resolvedAfterNSeconds: n &#125;); &#125;, n * 1000); &#125;);&#125;);var promiseTRJANSG = (promiseThatRejectsAfterNSecondsGenerator = function( n = 0) &#123; return new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; reject(&#123; rejectedAfterNSeconds: n &#125;); &#125;, n * 1000); &#125;);&#125;);console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(promiseTRSANSG(1));promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(2));var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.log(\"One of the promises failed with the following reason\", reason);&#125;);console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(1);promisesArray.push(4);promisesArray.push(2);var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.log(\"One of the promises failed with the following reason\", reason);&#125;);console.time(\"Promise.All\");var promisesArray = [];promisesArray.push(promiseTRSANSG(1));promisesArray.push(promiseTRSANSG(5));promisesArray.push(promiseTRSANSG(3));promisesArray.push(promiseTRJANSG(2));promisesArray.push(promiseTRSANSG(4));var handleAllPromises = Promise.all(promisesArray);handleAllPromises.then(function(values) &#123; console.timeEnd(\"Promise.All\"); console.log(\"All the promises are resolved\", values);&#125;);handleAllPromises.catch(function(reason) &#123; console.timeEnd(\"Promise.All\"); console.log(\"One of the promises failed with the following reason \", reason);&#125;);console.time(\"Promise.race\");var promisesArray = [];promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(3));promisesArray.push(promiseTRSANSG(2));promisesArray.push(promiseTRJANSG(3));promisesArray.push(promiseTRSANSG(4));var promisesRace = Promise.race(promisesArray);promisesRace.then(function(values) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fasted promise resolved\", values);&#125;);promisesRace.catch(function(reason) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fastest promise rejected with the following reason \", reason);&#125;);console.time(\"Promise.race\");var promisesArray = [];promisesArray.push(promiseTRSANSG(4));promisesArray.push(promiseTRSANSG(6));promisesArray.push(promiseTRSANSG(5));promisesArray.push(promiseTRJANSG(3));promisesArray.push(promiseTRSANSG(4));var promisesRace = Promise.race(promisesArray);promisesRace.then(function(values) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fasted promise resolved\", values);&#125;);promisesRace.catch(function(reason) &#123; console.timeEnd(\"Promise.race\"); console.log(\"The fastest promise rejected with the following reason \", reason);&#125;); Bluebird åº“è¿˜æœ‰ä¸€äº›æœ‰è¶£çš„åŠŸèƒ½æ¯”å¦‚ï¼š Promise.prototype.timeout Promise.some Promise.promisify æˆ‘ä»¬ä¼šåœ¨å•ç‹¬çš„æ–‡ç« ä¸­è®¨è®ºã€‚ æˆ‘è¿˜ä¼šå†™å‡ ç¯‡å…³äºæˆ‘å­¦ä¹  async å’Œ await çš„æ–‡ç« ã€‚ åœ¨ç»“æŸå‰æˆ‘æƒ³åˆ—ä¸€ä¸‹æˆ‘å­¦ä¹  Promise æœŸé—´å¸®åŠ©æˆ‘ä¿æŒå¤´è„‘æ¸…é†’çš„è¦ç‚¹ã€‚ ä½¿ç”¨ Promise çš„è¦ç‚¹ å½“ä½ æƒ³ç”¨å¼‚æ­¥æˆ–é˜»å¡å‹ä»£ç æ—¶è¯·ä½¿ç”¨ Promiseã€‚ åœ¨å®è·µä¸­å°† resoleve å¯¹åº” thenï¼Œreject å¯¹åº” catchã€‚ ç¡®ä¿ä¸ºæ‰€æœ‰çš„ Promise éƒ½å†™ä¸Š .catch å’Œ .thenã€‚ å¦‚æœæŸä¸ªæ“ä½œæ— è®ºå¦‚ä½•éƒ½è¦æ‰§è¡Œè¯·ä½¿ç”¨ .finally æ¯ä¸ª Promise åªèƒ½æ‰§è¡Œä¸€æ¬¡ã€‚ æˆ‘ä»¬å¯ä»¥ä¸ºä¸€ä¸ª Promise æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•°ã€‚ Promise å¯¹è±¡çš„æ–¹æ³•è¿”å›çš„æ•°æ®ç±»å‹éƒ½æ˜¯ Promiseï¼Œæ— è®ºæ—¶é™æ€æ–¹æ³•è¿˜æ˜¯åŸå‹æ–¹æ³•ã€‚ åœ¨ Promise.all ä¸­ï¼Œä¸ç®¡æ˜¯å“ªä¸ª Promise å…ˆæ‰§è¡Œå®Œæˆï¼Œè¿”å›å€¼çš„é¡ºåºä¸è¾“å…¥æ—¶ä¸€è‡´ã€‚ å¦‚æœæˆ‘é—æ¼äº†ä»»ä½•å†…å®¹ï¼Œæˆ–æ˜¯æœ‰ä»»ä½•å†…å®¹éœ€è¦ä¿®æ­£è¯·æŒ‡å‡ºã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨ MERN stack ä¸Šå¼€å‘æˆ‘ä»¬çš„äº§å“ https://learningpaths.io/ï¼Œæˆ‘å¼€å§‹èŠ±è´¹æ›´å¤šçš„æ—¶é—´åœ¨ JavaScript ä¸Šã€‚æˆ‘èŠ±äº†å‡ å¤©çš„æ—¶é—´æ¥é˜…è¯» Promise ç›¸å…³å†…å®¹ï¼Œè®°äº†ç›¸å½“å¤šçš„é“¾æ¥å’Œç¬”è®°ã€‚å› æ­¤æˆ‘ä»¬å¼€å§‹å¼€å‘ä¸€ä¸ª Chrome æ‰©å±•æ¥è§£å†³è¿™ä¸€ç—›ç‚¹ï¼Œè¿™ä¸ªæ‰©å±•å¯ä»¥å¸®ä½ ç®¡ç†ä½ çš„å­¦ä¹ è·¯çº¿ã€‚ç›®å‰æ­¤æ‰©å±•è¿˜åœ¨ alpha é˜¶æ®µï¼Œæˆ‘ä»¬æƒ³é€‰æ‹© 100 ä¸ªæ„¿æ„å°è¯•å¹¶æä¾›åé¦ˆçš„ç”¨æˆ·æ¥è¯•ç”¨å®ƒã€‚å¦‚æœä½ æ„Ÿå…´è¶£å¯ä»¥å» https://learningpaths.io/ ç”³è¯·æ—©æœŸè¯•ç”¨ã€‚å¦‚æœä½ è§‰å¾—ä½ çš„æœ‹å‹æˆ–åŒäº‹å¯èƒ½æ„Ÿå…´è¶£è¯·åˆ†äº«ç»™ä»–ä»¬ã€‚ å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å¹¶æƒ³é˜…è¯»å…¶ä»–ç±»ä¼¼æ–‡ç« ï¼Œåˆ«å¿˜äº†ç‚¹èµå“Ÿã€‚","link":"/2019/06/25/understanding-promise/"}],"tags":[{"name":"VueJS","slug":"VueJS","link":"/tags/VueJS/"},{"name":"jQuery","slug":"jQuery","link":"/tags/jQuery/"},{"name":"JavaScript","slug":"JavaScript","link":"/tags/JavaScript/"},{"name":"Promise","slug":"Promise","link":"/tags/Promise/"},{"name":"async","slug":"async","link":"/tags/async/"},{"name":"await","slug":"await","link":"/tags/await/"},{"name":"CSS","slug":"CSS","link":"/tags/CSS/"},{"name":"Hardware accelerate","slug":"Hardware-accelerate","link":"/tags/Hardware-accelerate/"},{"name":"ç¡¬ä»¶åŠ é€Ÿ","slug":"ç¡¬ä»¶åŠ é€Ÿ","link":"/tags/ç¡¬ä»¶åŠ é€Ÿ/"},{"name":"SVG","slug":"SVG","link":"/tags/SVG/"},{"name":"SVG åŠ¨ç”»","slug":"SVG-åŠ¨ç”»","link":"/tags/SVG-åŠ¨ç”»/"},{"name":"SVG Animation","slug":"SVG-Animation","link":"/tags/SVG-Animation/"},{"name":"Service Worker","slug":"Service-Worker","link":"/tags/Service-Worker/"},{"name":"App","slug":"App","link":"/tags/App/"},{"name":"JS åº”ç”¨","slug":"JS-åº”ç”¨","link":"/tags/JS-åº”ç”¨/"},{"name":"åº”ç”¨","slug":"åº”ç”¨","link":"/tags/åº”ç”¨/"},{"name":"Web Components","slug":"Web-Components","link":"/tags/Web-Components/"},{"name":"Web å¼€å‘","slug":"Web-å¼€å‘","link":"/tags/Web-å¼€å‘/"},{"name":"Super","slug":"Super","link":"/tags/Super/"},{"name":"Extends","slug":"Extends","link":"/tags/Extends/"},{"name":"JSå¯¹è±¡","slug":"JSå¯¹è±¡","link":"/tags/JSå¯¹è±¡/"},{"name":"Javascript","slug":"Javascript","link":"/tags/Javascript/"},{"name":"ES6","slug":"ES6","link":"/tags/ES6/"}],"categories":[]}